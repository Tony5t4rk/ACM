\begin{Verbatim}[commandchars=\\\{\}]
\PYG{c+cp}{\PYGZsh{}define mp make\PYGZus{}pair}
\PYG{c+cp}{\PYGZsh{}define fi first}
\PYG{c+cp}{\PYGZsh{}define se second}
\PYG{c+cp}{\PYGZsh{}define pb push\PYGZus{}back}
\PYG{k}{typedef} \PYG{k+kt}{double} \PYG{n}{db}\PYG{p}{;}
\PYG{k}{const} \PYG{n}{db} \PYG{n}{eps}\PYG{o}{=}\PYG{l+m+mf}{1e\PYGZhy{}6}\PYG{p}{;}
\PYG{k}{const} \PYG{n}{db} \PYG{n}{pi}\PYG{o}{=}\PYG{n}{acos}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{);}
\PYG{k+kt}{int} \PYG{n+nf}{sign}\PYG{p}{(}\PYG{n}{db} \PYG{n}{k}\PYG{p}{)\PYGZob{}}
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{k}\PYG{o}{\PYGZgt{}}\PYG{n}{eps}\PYG{p}{)} \PYG{k}{return} \PYG{l+m+mi}{1}\PYG{p}{;} \PYG{k}{else} \PYG{k}{if} \PYG{p}{(}\PYG{n}{k}\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{n}{eps}\PYG{p}{)} \PYG{k}{return} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{;} \PYG{k}{return} \PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{k+kt}{int} \PYG{n+nf}{cmp}\PYG{p}{(}\PYG{n}{db} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{db} \PYG{n}{k2}\PYG{p}{)\PYGZob{}}\PYG{k}{return} \PYG{n}{sign}\PYG{p}{(}\PYG{n}{k1}\PYG{o}{\PYGZhy{}}\PYG{n}{k2}\PYG{p}{);\PYGZcb{}}
\PYG{k+kt}{int} \PYG{n+nf}{inmid}\PYG{p}{(}\PYG{n}{db} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{db} \PYG{n}{k2}\PYG{p}{,}\PYG{n}{db} \PYG{n}{k3}\PYG{p}{)\PYGZob{}}\PYG{k}{return} \PYG{n}{sign}\PYG{p}{(}\PYG{n}{k1}\PYG{o}{\PYGZhy{}}\PYG{n}{k3}\PYG{p}{)}\PYG{o}{*}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{k2}\PYG{o}{\PYGZhy{}}\PYG{n}{k3}\PYG{p}{)}\PYG{o}{\PYGZlt{}=}\PYG{l+m+mi}{0}\PYG{p}{;\PYGZcb{}}\PYG{c+c1}{// k3 在 [k1,k2] 内 }
\PYG{k}{struct} \PYG{n}{point}\PYG{p}{\PYGZob{}}
  \PYG{n}{db} \PYG{n}{x}\PYG{p}{,}\PYG{n}{y}\PYG{p}{;}
  \PYG{n}{point} \PYG{k}{operator} \PYG{o}{+} \PYG{p}{(}\PYG{k}{const} \PYG{n}{point} \PYG{o}{\PYGZam{}}\PYG{n}{k1}\PYG{p}{)} \PYG{k}{const}\PYG{p}{\PYGZob{}}\PYG{k}{return} \PYG{p}{(}\PYG{n}{point}\PYG{p}{)\PYGZob{}}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{x}\PYG{o}{+}\PYG{n}{x}\PYG{p}{,}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{y}\PYG{o}{+}\PYG{n}{y}\PYG{p}{\PYGZcb{};\PYGZcb{}}
  \PYG{n}{point} \PYG{k}{operator} \PYG{o}{\PYGZhy{}} \PYG{p}{(}\PYG{k}{const} \PYG{n}{point} \PYG{o}{\PYGZam{}}\PYG{n}{k1}\PYG{p}{)} \PYG{k}{const}\PYG{p}{\PYGZob{}}\PYG{k}{return} \PYG{p}{(}\PYG{n}{point}\PYG{p}{)\PYGZob{}}\PYG{n}{x}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,}\PYG{n}{y}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{y}\PYG{p}{\PYGZcb{};\PYGZcb{}}
  \PYG{n}{point} \PYG{k}{operator} \PYG{o}{*} \PYG{p}{(}\PYG{n}{db} \PYG{n}{k1}\PYG{p}{)} \PYG{k}{const}\PYG{p}{\PYGZob{}}\PYG{k}{return} \PYG{p}{(}\PYG{n}{point}\PYG{p}{)\PYGZob{}}\PYG{n}{x}\PYG{o}{*}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{y}\PYG{o}{*}\PYG{n}{k1}\PYG{p}{\PYGZcb{};\PYGZcb{}}
  \PYG{n}{point} \PYG{k}{operator} \PYG{o}{/} \PYG{p}{(}\PYG{n}{db} \PYG{n}{k1}\PYG{p}{)} \PYG{k}{const}\PYG{p}{\PYGZob{}}\PYG{k}{return} \PYG{p}{(}\PYG{n}{point}\PYG{p}{)\PYGZob{}}\PYG{n}{x}\PYG{o}{/}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{y}\PYG{o}{/}\PYG{n}{k1}\PYG{p}{\PYGZcb{};\PYGZcb{}}
  \PYG{k+kt}{int} \PYG{k}{operator} \PYG{o}{==} \PYG{p}{(}\PYG{k}{const} \PYG{n}{point} \PYG{o}{\PYGZam{}}\PYG{n}{k1}\PYG{p}{)} \PYG{k}{const}\PYG{p}{\PYGZob{}}\PYG{k}{return} \PYG{n}{cmp}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{n}{cmp}\PYG{p}{(}\PYG{n}{y}\PYG{p}{,}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{y}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{p}{;\PYGZcb{}}
  \PYG{c+c1}{// 逆时针旋转 }
  \PYG{n}{point} \PYG{n}{turn}\PYG{p}{(}\PYG{n}{db} \PYG{n}{k1}\PYG{p}{)\PYGZob{}}\PYG{k}{return} \PYG{p}{(}\PYG{n}{point}\PYG{p}{)\PYGZob{}}\PYG{n}{x}\PYG{o}{*}\PYG{n}{cos}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{n}{y}\PYG{o}{*}\PYG{n}{sin}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{),}\PYG{n}{x}\PYG{o}{*}\PYG{n}{sin}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{)}\PYG{o}{+}\PYG{n}{y}\PYG{o}{*}\PYG{n}{cos}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{)\PYGZcb{};\PYGZcb{}}
  \PYG{n}{point} \PYG{n}{turn90}\PYG{p}{()\PYGZob{}}\PYG{k}{return} \PYG{p}{(}\PYG{n}{point}\PYG{p}{)\PYGZob{}}\PYG{o}{\PYGZhy{}}\PYG{n}{y}\PYG{p}{,}\PYG{n}{x}\PYG{p}{\PYGZcb{};\PYGZcb{}}
  \PYG{k+kt}{bool} \PYG{k}{operator} \PYG{o}{\PYGZlt{}} \PYG{p}{(}\PYG{k}{const} \PYG{n}{point} \PYG{n}{k1}\PYG{p}{)} \PYG{k}{const}\PYG{p}{\PYGZob{}}
    \PYG{k+kt}{int} \PYG{n}{a}\PYG{o}{=}\PYG{n}{cmp}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{);}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{a}\PYG{o}{==\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)} \PYG{k}{return} \PYG{l+m+mi}{1}\PYG{p}{;} \PYG{k}{else} \PYG{n+nf}{if} \PYG{p}{(}\PYG{n}{a}\PYG{o}{==}\PYG{l+m+mi}{1}\PYG{p}{)} \PYG{k}{return} \PYG{l+m+mi}{0}\PYG{p}{;} \PYG{k}{else} \PYG{k}{return} \PYG{n+nf}{cmp}\PYG{p}{(}\PYG{n}{y}\PYG{p}{,}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{y}\PYG{p}{)}\PYG{o}{==\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{;}
  \PYG{p}{\PYGZcb{}}
  \PYG{n}{db} \PYG{n}{abs}\PYG{p}{()\PYGZob{}}\PYG{k}{return} \PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{x}\PYG{o}{*}\PYG{n}{x}\PYG{o}{+}\PYG{n}{y}\PYG{o}{*}\PYG{n}{y}\PYG{p}{);\PYGZcb{}}
  \PYG{n}{db} \PYG{n}{abs2}\PYG{p}{()\PYGZob{}}\PYG{k}{return} \PYG{n}{x}\PYG{o}{*}\PYG{n}{x}\PYG{o}{+}\PYG{n}{y}\PYG{o}{*}\PYG{n}{y}\PYG{p}{;\PYGZcb{}}
  \PYG{n}{db} \PYG{n}{dis}\PYG{p}{(}\PYG{n}{point} \PYG{n}{k1}\PYG{p}{)\PYGZob{}}\PYG{k}{return} \PYG{p}{((}\PYG{o}{*}\PYG{k}{this}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{).}\PYG{n}{abs}\PYG{p}{();\PYGZcb{}}
  \PYG{n}{point} \PYG{n}{unit}\PYG{p}{()\PYGZob{}}\PYG{n}{db} \PYG{n}{w}\PYG{o}{=}\PYG{n}{abs}\PYG{p}{();} \PYG{k}{return} \PYG{p}{(}\PYG{n}{point}\PYG{p}{)\PYGZob{}}\PYG{n}{x}\PYG{o}{/}\PYG{n}{w}\PYG{p}{,}\PYG{n}{y}\PYG{o}{/}\PYG{n}{w}\PYG{p}{\PYGZcb{};\PYGZcb{}}
  \PYG{k+kt}{void} \PYG{n}{scan}\PYG{p}{()\PYGZob{}}\PYG{k+kt}{double} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{;} \PYG{n}{scanf}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}\PYGZpc{}lf\PYGZpc{}lf\PYGZdq{}}\PYG{p}{,}\PYG{o}{\PYGZam{}}\PYG{n}{k1}\PYG{p}{,}\PYG{o}{\PYGZam{}}\PYG{n}{k2}\PYG{p}{);} \PYG{n}{x}\PYG{o}{=}\PYG{n}{k1}\PYG{p}{;} \PYG{n}{y}\PYG{o}{=}\PYG{n}{k2}\PYG{p}{;\PYGZcb{}}
  \PYG{k+kt}{void} \PYG{n}{print}\PYG{p}{()\PYGZob{}}\PYG{n}{printf}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}\PYGZpc{}.11lf \PYGZpc{}.11lf}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{x}\PYG{p}{,}\PYG{n}{y}\PYG{p}{);\PYGZcb{}}
  \PYG{n}{db} \PYG{n}{getw}\PYG{p}{()\PYGZob{}}\PYG{k}{return} \PYG{n}{atan2}\PYG{p}{(}\PYG{n}{y}\PYG{p}{,}\PYG{n}{x}\PYG{p}{);\PYGZcb{}} 
  \PYG{n}{point} \PYG{n}{getdel}\PYG{p}{()\PYGZob{}}\PYG{k}{if} \PYG{p}{(}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}\PYG{o}{==\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{o}{||}\PYG{p}{(}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{y}\PYG{p}{)}\PYG{o}{==\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{))} \PYG{k}{return} \PYG{p}{(}\PYG{o}{*}\PYG{k}{this}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{);} \PYG{k}{else} \PYG{n+nf}{return} \PYG{p}{(}\PYG{o}{*}\PYG{k}{this}\PYG{p}{);\PYGZcb{}}
  \PYG{k+kt}{int} \PYG{n}{getP}\PYG{p}{()} \PYG{k}{const}\PYG{p}{\PYGZob{}}\PYG{k}{return} \PYG{n}{sign}\PYG{p}{(}\PYG{n}{y}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{1}\PYG{o}{||}\PYG{p}{(}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{y}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}\PYG{o}{==\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{);\PYGZcb{}}
\PYG{p}{\PYGZcb{};}
\PYG{k+kt}{int} \PYG{n+nf}{inmid}\PYG{p}{(}\PYG{n}{point} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k2}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k3}\PYG{p}{)\PYGZob{}}\PYG{k}{return} \PYG{n}{inmid}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,}\PYG{n}{k3}\PYG{p}{.}\PYG{n}{x}\PYG{p}{)}\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{n}{inmid}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{y}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{y}\PYG{p}{,}\PYG{n}{k3}\PYG{p}{.}\PYG{n}{y}\PYG{p}{);\PYGZcb{}}
\PYG{n}{db} \PYG{n+nf}{cross}\PYG{p}{(}\PYG{n}{point} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k2}\PYG{p}{)\PYGZob{}}\PYG{k}{return} \PYG{n}{k1}\PYG{p}{.}\PYG{n}{x}\PYG{o}{*}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{y}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{y}\PYG{o}{*}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{x}\PYG{p}{;\PYGZcb{}}
\PYG{n}{db} \PYG{n+nf}{dot}\PYG{p}{(}\PYG{n}{point} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k2}\PYG{p}{)\PYGZob{}}\PYG{k}{return} \PYG{n}{k1}\PYG{p}{.}\PYG{n}{x}\PYG{o}{*}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{x}\PYG{o}{+}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{y}\PYG{o}{*}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{y}\PYG{p}{;\PYGZcb{}}
\PYG{n}{db} \PYG{n+nf}{rad}\PYG{p}{(}\PYG{n}{point} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k2}\PYG{p}{)\PYGZob{}}\PYG{k}{return} \PYG{n}{atan2}\PYG{p}{(}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{),}\PYG{n}{dot}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{));\PYGZcb{}}
\PYG{c+c1}{// \PYGZhy{}pi \PYGZhy{}\PYGZgt{} pi}
\PYG{k+kt}{int} \PYG{n+nf}{compareangle} \PYG{p}{(}\PYG{n}{point} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k2}\PYG{p}{)\PYGZob{}}
  \PYG{k}{return} \PYG{n}{k1}\PYG{p}{.}\PYG{n}{getP}\PYG{p}{()}\PYG{o}{\PYGZlt{}}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{getP}\PYG{p}{()}\PYG{o}{||}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{getP}\PYG{p}{()}\PYG{o}{==}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{getP}\PYG{p}{()}\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{))}\PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{0}\PYG{p}{);}
\PYG{p}{\PYGZcb{}}
\PYG{n}{point} \PYG{n+nf}{proj}\PYG{p}{(}\PYG{n}{point} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k2}\PYG{p}{,}\PYG{n}{point} \PYG{n}{q}\PYG{p}{)\PYGZob{}} \PYG{c+c1}{// q 到直线 k1,k2 的投影 }
  \PYG{n}{point} \PYG{n}{k}\PYG{o}{=}\PYG{n}{k2}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{;} \PYG{k}{return} \PYG{n}{k1}\PYG{o}{+}\PYG{n}{k}\PYG{o}{*}\PYG{p}{(}\PYG{n}{dot}\PYG{p}{(}\PYG{n}{q}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k}\PYG{p}{)}\PYG{o}{/}\PYG{n}{k}\PYG{p}{.}\PYG{n}{abs2}\PYG{p}{());}
\PYG{p}{\PYGZcb{}}
\PYG{n}{point} \PYG{n+nf}{reflect}\PYG{p}{(}\PYG{n}{point} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k2}\PYG{p}{,}\PYG{n}{point} \PYG{n}{q}\PYG{p}{)\PYGZob{}}\PYG{k}{return} \PYG{n}{proj}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{,}\PYG{n}{q}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{\PYGZhy{}}\PYG{n}{q}\PYG{p}{;\PYGZcb{}}
\PYG{k+kt}{int} \PYG{n+nf}{clockwise}\PYG{p}{(}\PYG{n}{point} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k2}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k3}\PYG{p}{)\PYGZob{}}\PYG{c+c1}{// k1 k2 k3 逆时针 1 顺时针 \PYGZhy{}1 否则 0  }
  \PYG{k}{return} \PYG{n}{sign}\PYG{p}{(}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{k2}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k3}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{));}
\PYG{p}{\PYGZcb{}}
\PYG{k+kt}{int} \PYG{n+nf}{checkLL}\PYG{p}{(}\PYG{n}{point} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k2}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k3}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k4}\PYG{p}{)\PYGZob{}}\PYG{c+c1}{// 求直线 (L) 线段 (S)k1,k2 和 k3,k4 的交点 }
  \PYG{k}{return} \PYG{n}{cmp}\PYG{p}{(}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{k3}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k4}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{),}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{k3}\PYG{o}{\PYGZhy{}}\PYG{n}{k2}\PYG{p}{,}\PYG{n}{k4}\PYG{o}{\PYGZhy{}}\PYG{n}{k2}\PYG{p}{))}\PYG{o}{!=}\PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{n}{point} \PYG{n+nf}{getLL}\PYG{p}{(}\PYG{n}{point} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k2}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k3}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k4}\PYG{p}{)\PYGZob{}}
  \PYG{n}{db} \PYG{n}{w1}\PYG{o}{=}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{k1}\PYG{o}{\PYGZhy{}}\PYG{n}{k3}\PYG{p}{,}\PYG{n}{k4}\PYG{o}{\PYGZhy{}}\PYG{n}{k3}\PYG{p}{),}\PYG{n}{w2}\PYG{o}{=}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{k4}\PYG{o}{\PYGZhy{}}\PYG{n}{k3}\PYG{p}{,}\PYG{n}{k2}\PYG{o}{\PYGZhy{}}\PYG{n}{k3}\PYG{p}{);} \PYG{k}{return} \PYG{p}{(}\PYG{n}{k1}\PYG{o}{*}\PYG{n}{w2}\PYG{o}{+}\PYG{n}{k2}\PYG{o}{*}\PYG{n}{w1}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{n}{w1}\PYG{o}{+}\PYG{n}{w2}\PYG{p}{);}
\PYG{p}{\PYGZcb{}}
\PYG{k+kt}{int} \PYG{n+nf}{intersect}\PYG{p}{(}\PYG{n}{db} \PYG{n}{l1}\PYG{p}{,}\PYG{n}{db} \PYG{n}{r1}\PYG{p}{,}\PYG{n}{db} \PYG{n}{l2}\PYG{p}{,}\PYG{n}{db} \PYG{n}{r2}\PYG{p}{)\PYGZob{}}
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{l1}\PYG{o}{\PYGZgt{}}\PYG{n}{r1}\PYG{p}{)} \PYG{n}{swap}\PYG{p}{(}\PYG{n}{l1}\PYG{p}{,}\PYG{n}{r1}\PYG{p}{);} \PYG{k}{if} \PYG{p}{(}\PYG{n}{l2}\PYG{o}{\PYGZgt{}}\PYG{n}{r2}\PYG{p}{)} \PYG{n}{swap}\PYG{p}{(}\PYG{n}{l2}\PYG{p}{,}\PYG{n}{r2}\PYG{p}{);} \PYG{k}{return} \PYG{n}{cmp}\PYG{p}{(}\PYG{n}{r1}\PYG{p}{,}\PYG{n}{l2}\PYG{p}{)}\PYG{o}{!=\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{n}{cmp}\PYG{p}{(}\PYG{n}{r2}\PYG{p}{,}\PYG{n}{l1}\PYG{p}{)}\PYG{o}{!=\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{k+kt}{int} \PYG{n+nf}{checkSS}\PYG{p}{(}\PYG{n}{point} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k2}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k3}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k4}\PYG{p}{)\PYGZob{}}
  \PYG{k}{return} \PYG{n}{intersect}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,}\PYG{n}{k3}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,}\PYG{n}{k4}\PYG{p}{.}\PYG{n}{x}\PYG{p}{)}\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{n}{intersect}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{y}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{y}\PYG{p}{,}\PYG{n}{k3}\PYG{p}{.}\PYG{n}{y}\PYG{p}{,}\PYG{n}{k4}\PYG{p}{.}\PYG{n}{y}\PYG{p}{)}\PYG{o}{\PYGZam{}\PYGZam{}}
  \PYG{n}{sign}\PYG{p}{(}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{k3}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k4}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{))}\PYG{o}{*}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{k3}\PYG{o}{\PYGZhy{}}\PYG{n}{k2}\PYG{p}{,}\PYG{n}{k4}\PYG{o}{\PYGZhy{}}\PYG{n}{k2}\PYG{p}{))}\PYG{o}{\PYGZlt{}=}\PYG{l+m+mi}{0}\PYG{o}{\PYGZam{}\PYGZam{}}
  \PYG{n}{sign}\PYG{p}{(}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{k1}\PYG{o}{\PYGZhy{}}\PYG{n}{k3}\PYG{p}{,}\PYG{n}{k2}\PYG{o}{\PYGZhy{}}\PYG{n}{k3}\PYG{p}{))}\PYG{o}{*}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{k1}\PYG{o}{\PYGZhy{}}\PYG{n}{k4}\PYG{p}{,}\PYG{n}{k2}\PYG{o}{\PYGZhy{}}\PYG{n}{k4}\PYG{p}{))}\PYG{o}{\PYGZlt{}=}\PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{n}{db} \PYG{n+nf}{disSP}\PYG{p}{(}\PYG{n}{point} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k2}\PYG{p}{,}\PYG{n}{point} \PYG{n}{q}\PYG{p}{)\PYGZob{}}
  \PYG{n}{point} \PYG{n}{k3}\PYG{o}{=}\PYG{n}{proj}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{,}\PYG{n}{q}\PYG{p}{);}
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{inmid}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{,}\PYG{n}{k3}\PYG{p}{))} \PYG{k}{return} \PYG{n}{q}\PYG{p}{.}\PYG{n}{dis}\PYG{p}{(}\PYG{n}{k3}\PYG{p}{);} \PYG{k}{else} \PYG{k}{return} \PYG{n}{min}\PYG{p}{(}\PYG{n}{q}\PYG{p}{.}\PYG{n}{dis}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{),}\PYG{n}{q}\PYG{p}{.}\PYG{n}{dis}\PYG{p}{(}\PYG{n}{k2}\PYG{p}{));}
\PYG{p}{\PYGZcb{}}
\PYG{n}{db} \PYG{n+nf}{disSS}\PYG{p}{(}\PYG{n}{point} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k2}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k3}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k4}\PYG{p}{)\PYGZob{}}
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{checkSS}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{,}\PYG{n}{k3}\PYG{p}{,}\PYG{n}{k4}\PYG{p}{))} \PYG{k}{return} \PYG{l+m+mi}{0}\PYG{p}{;}
  \PYG{k}{else} \PYG{k}{return} \PYG{n}{min}\PYG{p}{(}\PYG{n}{min}\PYG{p}{(}\PYG{n}{disSP}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{,}\PYG{n}{k3}\PYG{p}{),}\PYG{n}{disSP}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{,}\PYG{n}{k4}\PYG{p}{)),}\PYG{n}{min}\PYG{p}{(}\PYG{n}{disSP}\PYG{p}{(}\PYG{n}{k3}\PYG{p}{,}\PYG{n}{k4}\PYG{p}{,}\PYG{n}{k1}\PYG{p}{),}\PYG{n}{disSP}\PYG{p}{(}\PYG{n}{k3}\PYG{p}{,}\PYG{n}{k4}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{)));}
\PYG{p}{\PYGZcb{}}
\PYG{k+kt}{int} \PYG{n+nf}{onS}\PYG{p}{(}\PYG{n}{point} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k2}\PYG{p}{,}\PYG{n}{point} \PYG{n}{q}\PYG{p}{)\PYGZob{}}\PYG{k}{return} \PYG{n}{inmid}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{,}\PYG{n}{q}\PYG{p}{)}\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{k1}\PYG{o}{\PYGZhy{}}\PYG{n}{q}\PYG{p}{,}\PYG{n}{k2}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{))}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{p}{;\PYGZcb{}}
\PYG{k}{struct} \PYG{n}{circle}\PYG{p}{\PYGZob{}}
  \PYG{n}{point} \PYG{n}{o}\PYG{p}{;} \PYG{n}{db} \PYG{n}{r}\PYG{p}{;}
  \PYG{k+kt}{void} \PYG{n+nf}{scan}\PYG{p}{()\PYGZob{}}\PYG{n}{o}\PYG{p}{.}\PYG{n}{scan}\PYG{p}{();} \PYG{n}{scanf}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}\PYGZpc{}lf\PYGZdq{}}\PYG{p}{,}\PYG{o}{\PYGZam{}}\PYG{n}{r}\PYG{p}{);\PYGZcb{}}
  \PYG{k+kt}{int} \PYG{n+nf}{inside}\PYG{p}{(}\PYG{n}{point} \PYG{n}{k}\PYG{p}{)\PYGZob{}}\PYG{k}{return} \PYG{n}{cmp}\PYG{p}{(}\PYG{n}{r}\PYG{p}{,}\PYG{n}{o}\PYG{p}{.}\PYG{n}{dis}\PYG{p}{(}\PYG{n}{k}\PYG{p}{));\PYGZcb{}}
\PYG{p}{\PYGZcb{};}
\PYG{k}{struct} \PYG{n}{line}\PYG{p}{\PYGZob{}}
  \PYG{c+c1}{// p[0]\PYGZhy{}\PYGZgt{}p[1]}
  \PYG{n}{point} \PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{];}
  \PYG{n}{line}\PYG{p}{(}\PYG{n}{point} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k2}\PYG{p}{)\PYGZob{}}\PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{=}\PYG{n}{k1}\PYG{p}{;} \PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{=}\PYG{n}{k2}\PYG{p}{;\PYGZcb{}}
  \PYG{n}{point}\PYG{o}{\PYGZam{}} \PYG{k}{operator} \PYG{p}{[]} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{k}\PYG{p}{)\PYGZob{}}\PYG{k}{return} \PYG{n}{p}\PYG{p}{[}\PYG{n}{k}\PYG{p}{];\PYGZcb{}}
  \PYG{k+kt}{int} \PYG{n}{include}\PYG{p}{(}\PYG{n}{point} \PYG{n}{k}\PYG{p}{)\PYGZob{}}\PYG{k}{return} \PYG{n}{sign}\PYG{p}{(}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{],}\PYG{n}{k}\PYG{o}{\PYGZhy{}}\PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]))}\PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{0}\PYG{p}{;\PYGZcb{}}
  \PYG{n}{point} \PYG{n}{dir}\PYG{p}{()\PYGZob{}}\PYG{k}{return} \PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{];\PYGZcb{}}
  \PYG{n}{line} \PYG{n}{push}\PYG{p}{()\PYGZob{}} \PYG{c+c1}{// 向外 ( 左手边 ) 平移 eps }
    \PYG{k}{const} \PYG{n}{db} \PYG{n}{eps} \PYG{o}{=} \PYG{l+m+mf}{1e\PYGZhy{}6}\PYG{p}{;}
    \PYG{n}{point} \PYG{n}{delta}\PYG{o}{=}\PYG{p}{(}\PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]).}\PYG{n}{turn90}\PYG{p}{().}\PYG{n}{unit}\PYG{p}{()}\PYG{o}{*}\PYG{n}{eps}\PYG{p}{;}
    \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{delta}\PYG{p}{,}\PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{delta}\PYG{p}{\PYGZcb{};}
  \PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{};}
\PYG{n}{point} \PYG{n+nf}{getLL}\PYG{p}{(}\PYG{n}{line} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{line} \PYG{n}{k2}\PYG{p}{)\PYGZob{}}\PYG{k}{return} \PYG{n}{getLL}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{],}\PYG{n}{k1}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{],}\PYG{n}{k2}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{],}\PYG{n}{k2}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]);\PYGZcb{}}
\PYG{k+kt}{int} \PYG{n+nf}{parallel}\PYG{p}{(}\PYG{n}{line} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{line} \PYG{n}{k2}\PYG{p}{)\PYGZob{}}\PYG{k}{return} \PYG{n}{sign}\PYG{p}{(}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{dir}\PYG{p}{(),}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{dir}\PYG{p}{()))}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{p}{;\PYGZcb{}}
\PYG{k+kt}{int} \PYG{n+nf}{sameDir}\PYG{p}{(}\PYG{n}{line} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{line} \PYG{n}{k2}\PYG{p}{)\PYGZob{}}\PYG{k}{return} \PYG{n}{parallel}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{)}\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{dot}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{dir}\PYG{p}{(),}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{dir}\PYG{p}{()))}\PYG{o}{==}\PYG{l+m+mi}{1}\PYG{p}{;\PYGZcb{}}
\PYG{k+kt}{int} \PYG{k}{operator} \PYG{o}{\PYGZlt{}} \PYG{p}{(}\PYG{n}{line} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{line} \PYG{n}{k2}\PYG{p}{)\PYGZob{}}
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{sameDir}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{))} \PYG{k}{return} \PYG{n}{k2}\PYG{p}{.}\PYG{n}{include}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]);} 
  \PYG{k}{return} \PYG{n+nf}{compareangle}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{dir}\PYG{p}{(),}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{dir}\PYG{p}{());}
\PYG{p}{\PYGZcb{}}
\PYG{k+kt}{int} \PYG{n}{checkpos}\PYG{p}{(}\PYG{n}{line} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{line} \PYG{n}{k2}\PYG{p}{,}\PYG{n}{line} \PYG{n}{k3}\PYG{p}{)\PYGZob{}}\PYG{k}{return} \PYG{n}{k3}\PYG{p}{.}\PYG{n}{include}\PYG{p}{(}\PYG{n}{getLL}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{));\PYGZcb{}}
\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{line}\PYG{o}{\PYGZgt{}} \PYG{n}{getHL}\PYG{p}{(}\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{line}\PYG{o}{\PYGZgt{}} \PYG{o}{\PYGZam{}}\PYG{n}{L}\PYG{p}{)\PYGZob{}} \PYG{c+c1}{// 求半平面交 , 半平面是逆时针方向 , 输出按照逆时针}
  \PYG{n}{sort}\PYG{p}{(}\PYG{n}{L}\PYG{p}{.}\PYG{n}{begin}\PYG{p}{(),}\PYG{n}{L}\PYG{p}{.}\PYG{n}{end}\PYG{p}{());} \PYG{n}{deque}\PYG{o}{\PYGZlt{}}\PYG{n}{line}\PYG{o}{\PYGZgt{}} \PYG{n}{q}\PYG{p}{;}
  \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}}\PYG{p}{(}\PYG{k+kt}{int}\PYG{p}{)}\PYG{n}{L}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)\PYGZob{}}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{i}\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{n}{sameDir}\PYG{p}{(}\PYG{n}{L}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],}\PYG{n}{L}\PYG{p}{[}\PYG{n}{i}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]))} \PYG{k}{continue}\PYG{p}{;}
    \PYG{k}{while} \PYG{p}{(}\PYG{n}{q}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{1}\PYG{o}{\PYGZam{}\PYGZam{}!}\PYG{n}{checkpos}\PYG{p}{(}\PYG{n}{q}\PYG{p}{[}\PYG{n}{q}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{],}\PYG{n}{q}\PYG{p}{[}\PYG{n}{q}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{],}\PYG{n}{L}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]))} \PYG{n}{q}\PYG{p}{.}\PYG{n}{pop\PYGZus{}back}\PYG{p}{();}
    \PYG{k}{while} \PYG{p}{(}\PYG{n}{q}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{1}\PYG{o}{\PYGZam{}\PYGZam{}!}\PYG{n}{checkpos}\PYG{p}{(}\PYG{n}{q}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{],}\PYG{n}{q}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{],}\PYG{n}{L}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]))} \PYG{n}{q}\PYG{p}{.}\PYG{n}{pop\PYGZus{}front}\PYG{p}{();}
    \PYG{n}{q}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{L}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]);}
  \PYG{p}{\PYGZcb{}}
  \PYG{k}{while} \PYG{p}{(}\PYG{n}{q}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{2}\PYG{o}{\PYGZam{}\PYGZam{}!}\PYG{n}{checkpos}\PYG{p}{(}\PYG{n}{q}\PYG{p}{[}\PYG{n}{q}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{],}\PYG{n}{q}\PYG{p}{[}\PYG{n}{q}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{],}\PYG{n}{q}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]))} \PYG{n}{q}\PYG{p}{.}\PYG{n}{pop\PYGZus{}back}\PYG{p}{();}
  \PYG{k}{while} \PYG{p}{(}\PYG{n}{q}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{2}\PYG{o}{\PYGZam{}\PYGZam{}!}\PYG{n}{checkpos}\PYG{p}{(}\PYG{n}{q}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{],}\PYG{n}{q}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{],}\PYG{n}{q}\PYG{p}{[}\PYG{n}{q}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]))} \PYG{n}{q}\PYG{p}{.}\PYG{n}{pop\PYGZus{}front}\PYG{p}{();}
  \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{line}\PYG{o}{\PYGZgt{}}\PYG{n}{ans}\PYG{p}{;} \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}}\PYG{n}{q}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)} \PYG{n}{ans}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{q}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]);}
  \PYG{k}{return} \PYG{n}{ans}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{n}{db} \PYG{n}{closepoint}\PYG{p}{(}\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}\PYGZam{}}\PYG{n}{A}\PYG{p}{,}\PYG{k+kt}{int} \PYG{n}{l}\PYG{p}{,}\PYG{k+kt}{int} \PYG{n}{r}\PYG{p}{)\PYGZob{}} \PYG{c+c1}{// 最近点对 , 先要按照 x 坐标排序 }
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{r}\PYG{o}{\PYGZhy{}}\PYG{n}{l}\PYG{o}{\PYGZlt{}=}\PYG{l+m+mi}{5}\PYG{p}{)\PYGZob{}}
    \PYG{n}{db} \PYG{n}{ans}\PYG{o}{=}\PYG{l+m+mf}{1e20}\PYG{p}{;}
    \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{n}{l}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}=}\PYG{n}{r}\PYG{p}{;}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)} \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{j}\PYG{o}{=}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{n}{j}\PYG{o}{\PYGZlt{}=}\PYG{n}{r}\PYG{p}{;}\PYG{n}{j}\PYG{o}{++}\PYG{p}{)} \PYG{n}{ans}\PYG{o}{=}\PYG{n}{min}\PYG{p}{(}\PYG{n}{ans}\PYG{p}{,}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{dis}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]));}
    \PYG{k}{return} \PYG{n}{ans}\PYG{p}{;}
  \PYG{p}{\PYGZcb{}}
  \PYG{k+kt}{int} \PYG{n}{mid}\PYG{o}{=}\PYG{n}{l}\PYG{o}{+}\PYG{n}{r}\PYG{o}{\PYGZgt{}\PYGZgt{}}\PYG{l+m+mi}{1}\PYG{p}{;} \PYG{n}{db} \PYG{n}{ans}\PYG{o}{=}\PYG{n}{min}\PYG{p}{(}\PYG{n}{closepoint}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,}\PYG{n}{l}\PYG{p}{,}\PYG{n}{mid}\PYG{p}{),}\PYG{n}{closepoint}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,}\PYG{n}{mid}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{r}\PYG{p}{));}
  \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}}\PYG{n}{B}\PYG{p}{;} \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{n}{l}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}=}\PYG{n}{r}\PYG{p}{;}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)} \PYG{k}{if} \PYG{p}{(}\PYG{n}{abs}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{x}\PYG{o}{\PYGZhy{}}\PYG{n}{A}\PYG{p}{[}\PYG{n}{mid}\PYG{p}{].}\PYG{n}{x}\PYG{p}{)}\PYG{o}{\PYGZlt{}=}\PYG{n}{ans}\PYG{p}{)} \PYG{n}{B}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]);}
  \PYG{n}{sort}\PYG{p}{(}\PYG{n}{B}\PYG{p}{.}\PYG{n}{begin}\PYG{p}{(),}\PYG{n}{B}\PYG{p}{.}\PYG{n}{end}\PYG{p}{(),[](}\PYG{n}{point} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k2}\PYG{p}{)\PYGZob{}}\PYG{k}{return} \PYG{n}{k1}\PYG{p}{.}\PYG{n}{y}\PYG{o}{\PYGZlt{}}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{y}\PYG{p}{;\PYGZcb{});}
  \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}}\PYG{n}{B}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)} \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{j}\PYG{o}{=}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{n}{j}\PYG{o}{\PYGZlt{}}\PYG{n}{B}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{n}{B}\PYG{p}{[}\PYG{n}{j}\PYG{p}{].}\PYG{n}{y}\PYG{o}{\PYGZhy{}}\PYG{n}{B}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{y}\PYG{o}{\PYGZlt{}}\PYG{n}{ans}\PYG{p}{;}\PYG{n}{j}\PYG{o}{++}\PYG{p}{)} \PYG{n}{ans}\PYG{o}{=}\PYG{n}{min}\PYG{p}{(}\PYG{n}{ans}\PYG{p}{,}\PYG{n}{B}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{dis}\PYG{p}{(}\PYG{n}{B}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]));}
  \PYG{k}{return} \PYG{n}{ans}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{k+kt}{int} \PYG{n}{checkposCC}\PYG{p}{(}\PYG{n}{circle} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{circle} \PYG{n}{k2}\PYG{p}{)\PYGZob{}}\PYG{c+c1}{// 返回两个圆的公切线数量}
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{cmp}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{r}\PYG{p}{)}\PYG{o}{==\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)} \PYG{n}{swap}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{);}
  \PYG{n}{db} \PYG{n}{dis}\PYG{o}{=}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{o}\PYG{p}{.}\PYG{n}{dis}\PYG{p}{(}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{o}\PYG{p}{);}  \PYG{k+kt}{int} \PYG{n}{w1}\PYG{o}{=}\PYG{n}{cmp}\PYG{p}{(}\PYG{n}{dis}\PYG{p}{,}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{+}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{r}\PYG{p}{),}\PYG{n}{w2}\PYG{o}{=}\PYG{n}{cmp}\PYG{p}{(}\PYG{n}{dis}\PYG{p}{,}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{\PYGZhy{}}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{r}\PYG{p}{);}
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{w1}\PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{return} \PYG{l+m+mi}{4}\PYG{p}{;} \PYG{k}{else} \PYG{n+nf}{if} \PYG{p}{(}\PYG{n}{w1}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{return} \PYG{l+m+mi}{3}\PYG{p}{;} \PYG{k}{else} \PYG{n+nf}{if} \PYG{p}{(}\PYG{n}{w2}\PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{return} \PYG{l+m+mi}{2}\PYG{p}{;} 
  \PYG{k}{else} \PYG{n+nf}{if} \PYG{p}{(}\PYG{n}{w2}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{return} \PYG{l+m+mi}{1}\PYG{p}{;} \PYG{k}{else} \PYG{k}{return} \PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}} \PYG{n}{getCL}\PYG{p}{(}\PYG{n}{circle} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k2}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k3}\PYG{p}{)\PYGZob{}} \PYG{c+c1}{// 沿着 k2\PYGZhy{}\PYGZgt{}k3 方向给出 , 相切给出两个 }
  \PYG{n}{point} \PYG{n}{k}\PYG{o}{=}\PYG{n}{proj}\PYG{p}{(}\PYG{n}{k2}\PYG{p}{,}\PYG{n}{k3}\PYG{p}{,}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{o}\PYG{p}{);} \PYG{n}{db} \PYG{n}{d}\PYG{o}{=}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{*}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{\PYGZhy{}}\PYG{p}{(}\PYG{n}{k}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{o}\PYG{p}{).}\PYG{n}{abs2}\PYG{p}{();}
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{d}\PYG{p}{)}\PYG{o}{==\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)} \PYG{k}{return} \PYG{p}{\PYGZob{}\PYGZcb{};}
  \PYG{n}{point} \PYG{n}{del}\PYG{o}{=}\PYG{p}{(}\PYG{n}{k3}\PYG{o}{\PYGZhy{}}\PYG{n}{k2}\PYG{p}{).}\PYG{n}{unit}\PYG{p}{()}\PYG{o}{*}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{max}\PYG{p}{((}\PYG{n}{db}\PYG{p}{)}\PYG{l+m+mf}{0.0}\PYG{p}{,}\PYG{n}{d}\PYG{p}{));} \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{n}{k}\PYG{o}{\PYGZhy{}}\PYG{n}{del}\PYG{p}{,}\PYG{n}{k}\PYG{o}{+}\PYG{n}{del}\PYG{p}{\PYGZcb{};}
\PYG{p}{\PYGZcb{}}
\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}} \PYG{n}{getCC}\PYG{p}{(}\PYG{n}{circle} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{circle} \PYG{n}{k2}\PYG{p}{)\PYGZob{}}\PYG{c+c1}{// 沿圆 k1 逆时针给出 , 相切给出两个 }
  \PYG{k+kt}{int} \PYG{n}{pd}\PYG{o}{=}\PYG{n}{checkposCC}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{);} \PYG{k}{if} \PYG{p}{(}\PYG{n}{pd}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{o}{||}\PYG{n}{pd}\PYG{o}{==}\PYG{l+m+mi}{4}\PYG{p}{)} \PYG{k}{return} \PYG{p}{\PYGZob{}\PYGZcb{};}
  \PYG{n}{db} \PYG{n}{a}\PYG{o}{=}\PYG{p}{(}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{o}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{o}\PYG{p}{).}\PYG{n}{abs2}\PYG{p}{(),}\PYG{n}{cosA}\PYG{o}{=}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{*}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{+}\PYG{n}{a}\PYG{o}{\PYGZhy{}}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{r}\PYG{o}{*}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{r}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{*}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{max}\PYG{p}{(}\PYG{n}{a}\PYG{p}{,(}\PYG{n}{db}\PYG{p}{)}\PYG{l+m+mf}{0.0}\PYG{p}{)));}
  \PYG{n}{db} \PYG{n}{b}\PYG{o}{=}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{*}\PYG{n}{cosA}\PYG{p}{,}\PYG{n}{c}\PYG{o}{=}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{max}\PYG{p}{((}\PYG{n}{db}\PYG{p}{)}\PYG{l+m+mf}{0.0}\PYG{p}{,}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{*}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{\PYGZhy{}}\PYG{n}{b}\PYG{o}{*}\PYG{n}{b}\PYG{p}{));}
  \PYG{n}{point} \PYG{n}{k}\PYG{o}{=}\PYG{p}{(}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{o}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{o}\PYG{p}{).}\PYG{n}{unit}\PYG{p}{(),}\PYG{n}{m}\PYG{o}{=}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{o}\PYG{o}{+}\PYG{n}{k}\PYG{o}{*}\PYG{n}{b}\PYG{p}{,}\PYG{n}{del}\PYG{o}{=}\PYG{n}{k}\PYG{p}{.}\PYG{n}{turn90}\PYG{p}{()}\PYG{o}{*}\PYG{n}{c}\PYG{p}{;}
  \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{n}{m}\PYG{o}{\PYGZhy{}}\PYG{n}{del}\PYG{p}{,}\PYG{n}{m}\PYG{o}{+}\PYG{n}{del}\PYG{p}{\PYGZcb{};}
\PYG{p}{\PYGZcb{}} 
\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}} \PYG{n}{TangentCP}\PYG{p}{(}\PYG{n}{circle} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k2}\PYG{p}{)\PYGZob{}}\PYG{c+c1}{// 沿圆 k1 逆时针给出 }
  \PYG{n}{db} \PYG{n}{a}\PYG{o}{=}\PYG{p}{(}\PYG{n}{k2}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{o}\PYG{p}{).}\PYG{n}{abs}\PYG{p}{(),}\PYG{n}{b}\PYG{o}{=}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{*}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{/}\PYG{n}{a}\PYG{p}{,}\PYG{n}{c}\PYG{o}{=}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{max}\PYG{p}{((}\PYG{n}{db}\PYG{p}{)}\PYG{l+m+mf}{0.0}\PYG{p}{,}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{*}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{\PYGZhy{}}\PYG{n}{b}\PYG{o}{*}\PYG{n}{b}\PYG{p}{));}
  \PYG{n}{point} \PYG{n}{k}\PYG{o}{=}\PYG{p}{(}\PYG{n}{k2}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{o}\PYG{p}{).}\PYG{n}{unit}\PYG{p}{(),}\PYG{n}{m}\PYG{o}{=}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{o}\PYG{o}{+}\PYG{n}{k}\PYG{o}{*}\PYG{n}{b}\PYG{p}{,}\PYG{n}{del}\PYG{o}{=}\PYG{n}{k}\PYG{p}{.}\PYG{n}{turn90}\PYG{p}{()}\PYG{o}{*}\PYG{n}{c}\PYG{p}{;}
  \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{n}{m}\PYG{o}{\PYGZhy{}}\PYG{n}{del}\PYG{p}{,}\PYG{n}{m}\PYG{o}{+}\PYG{n}{del}\PYG{p}{\PYGZcb{};}
\PYG{p}{\PYGZcb{}} 
\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{line}\PYG{o}{\PYGZgt{}} \PYG{n}{TangentoutCC}\PYG{p}{(}\PYG{n}{circle} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{circle} \PYG{n}{k2}\PYG{p}{)\PYGZob{}}
  \PYG{k+kt}{int} \PYG{n}{pd}\PYG{o}{=}\PYG{n}{checkposCC}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{);} \PYG{k}{if} \PYG{p}{(}\PYG{n}{pd}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{return} \PYG{p}{\PYGZob{}\PYGZcb{};} 
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{pd}\PYG{o}{==}\PYG{l+m+mi}{1}\PYG{p}{)\PYGZob{}}\PYG{n}{point} \PYG{n}{k}\PYG{o}{=}\PYG{n}{getCC}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{)[}\PYG{l+m+mi}{0}\PYG{p}{];} \PYG{k}{return} \PYG{p}{\PYGZob{}(}\PYG{n}{line}\PYG{p}{)\PYGZob{}}\PYG{n}{k}\PYG{p}{,}\PYG{n}{k}\PYG{p}{\PYGZcb{}\PYGZcb{};\PYGZcb{}}
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{cmp}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{r}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{p}{)\PYGZob{}}
    \PYG{n}{point} \PYG{n}{del}\PYG{o}{=}\PYG{p}{(}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{o}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{o}\PYG{p}{).}\PYG{n}{unit}\PYG{p}{().}\PYG{n}{turn90}\PYG{p}{().}\PYG{n}{getdel}\PYG{p}{();}
    \PYG{k}{return} \PYG{p}{\PYGZob{}(}\PYG{n}{line}\PYG{p}{)\PYGZob{}}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{o}\PYG{o}{\PYGZhy{}}\PYG{n}{del}\PYG{o}{*}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{o}\PYG{o}{\PYGZhy{}}\PYG{n}{del}\PYG{o}{*}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{r}\PYG{p}{\PYGZcb{},(}\PYG{n}{line}\PYG{p}{)\PYGZob{}}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{o}\PYG{o}{+}\PYG{n}{del}\PYG{o}{*}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{o}\PYG{o}{+}\PYG{n}{del}\PYG{o}{*}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{r}\PYG{p}{\PYGZcb{}\PYGZcb{};}
  \PYG{p}{\PYGZcb{}} \PYG{k}{else} \PYG{p}{\PYGZob{}}
    \PYG{n}{point} \PYG{n}{p}\PYG{o}{=}\PYG{p}{(}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{o}\PYG{o}{*}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{o}\PYG{o}{*}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{r}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{\PYGZhy{}}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{r}\PYG{p}{);}
    \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}}\PYG{n}{A}\PYG{o}{=}\PYG{n}{TangentCP}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{p}\PYG{p}{),}\PYG{n}{B}\PYG{o}{=}\PYG{n}{TangentCP}\PYG{p}{(}\PYG{n}{k2}\PYG{p}{,}\PYG{n}{p}\PYG{p}{);}
    \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{line}\PYG{o}{\PYGZgt{}}\PYG{n}{ans}\PYG{p}{;} \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}}\PYG{n}{A}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)} \PYG{n}{ans}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{((}\PYG{n}{line}\PYG{p}{)\PYGZob{}}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],}\PYG{n}{B}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]\PYGZcb{});} 
    \PYG{k}{return} \PYG{n}{ans}\PYG{p}{;}
  \PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{}}
\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{line}\PYG{o}{\PYGZgt{}} \PYG{n}{TangentinCC}\PYG{p}{(}\PYG{n}{circle} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{circle} \PYG{n}{k2}\PYG{p}{)\PYGZob{}}
  \PYG{k+kt}{int} \PYG{n}{pd}\PYG{o}{=}\PYG{n}{checkposCC}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{);} \PYG{k}{if} \PYG{p}{(}\PYG{n}{pd}\PYG{o}{\PYGZlt{}=}\PYG{l+m+mi}{2}\PYG{p}{)} \PYG{k}{return} \PYG{p}{\PYGZob{}\PYGZcb{};}
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{pd}\PYG{o}{==}\PYG{l+m+mi}{3}\PYG{p}{)\PYGZob{}}\PYG{n}{point} \PYG{n}{k}\PYG{o}{=}\PYG{n}{getCC}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{)[}\PYG{l+m+mi}{0}\PYG{p}{];} \PYG{k}{return} \PYG{p}{\PYGZob{}(}\PYG{n}{line}\PYG{p}{)\PYGZob{}}\PYG{n}{k}\PYG{p}{,}\PYG{n}{k}\PYG{p}{\PYGZcb{}\PYGZcb{};\PYGZcb{}} 
  \PYG{n}{point} \PYG{n}{p}\PYG{o}{=}\PYG{p}{(}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{o}\PYG{o}{*}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{+}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{o}\PYG{o}{*}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{r}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{+}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{r}\PYG{p}{);}
  \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}}\PYG{n}{A}\PYG{o}{=}\PYG{n}{TangentCP}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{p}\PYG{p}{),}\PYG{n}{B}\PYG{o}{=}\PYG{n}{TangentCP}\PYG{p}{(}\PYG{n}{k2}\PYG{p}{,}\PYG{n}{p}\PYG{p}{);}
  \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{line}\PYG{o}{\PYGZgt{}}\PYG{n}{ans}\PYG{p}{;} \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}}\PYG{n}{A}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)} \PYG{n}{ans}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{((}\PYG{n}{line}\PYG{p}{)\PYGZob{}}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],}\PYG{n}{B}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]\PYGZcb{});} 
  \PYG{k}{return} \PYG{n}{ans}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{line}\PYG{o}{\PYGZgt{}} \PYG{n}{TangentCC}\PYG{p}{(}\PYG{n}{circle} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{circle} \PYG{n}{k2}\PYG{p}{)\PYGZob{}}
  \PYG{k+kt}{int} \PYG{n}{flag}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;} \PYG{k}{if} \PYG{p}{(}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{\PYGZlt{}}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{r}\PYG{p}{)} \PYG{n}{swap}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{),}\PYG{n}{flag}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{;}
  \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{line}\PYG{o}{\PYGZgt{}}\PYG{n}{A}\PYG{o}{=}\PYG{n}{TangentoutCC}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{),}\PYG{n}{B}\PYG{o}{=}\PYG{n}{TangentinCC}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{);}
  \PYG{k}{for} \PYG{p}{(}\PYG{n}{line} \PYG{n+nl}{k}\PYG{p}{:}\PYG{n}{B}\PYG{p}{)} \PYG{n}{A}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{k}\PYG{p}{);} 
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{flag}\PYG{p}{)} \PYG{k}{for} \PYG{p}{(}\PYG{n}{line} \PYG{o}{\PYGZam{}}\PYG{n+nl}{k}\PYG{p}{:}\PYG{n}{A}\PYG{p}{)} \PYG{n}{swap}\PYG{p}{(}\PYG{n}{k}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{],}\PYG{n}{k}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]);}
  \PYG{k}{return} \PYG{n}{A}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{n}{db} \PYG{n}{getarea}\PYG{p}{(}\PYG{n}{circle} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k2}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k3}\PYG{p}{)\PYGZob{}}
  \PYG{c+c1}{// 圆 k1 与三角形 k2 k3 k1.o 的有向面积交}
  \PYG{n}{point} \PYG{n}{k}\PYG{o}{=}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{o}\PYG{p}{;} \PYG{n}{k1}\PYG{p}{.}\PYG{n}{o}\PYG{o}{=}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{o}\PYG{o}{\PYGZhy{}}\PYG{n}{k}\PYG{p}{;} \PYG{n}{k2}\PYG{o}{=}\PYG{n}{k2}\PYG{o}{\PYGZhy{}}\PYG{n}{k}\PYG{p}{;} \PYG{n}{k3}\PYG{o}{=}\PYG{n}{k3}\PYG{o}{\PYGZhy{}}\PYG{n}{k}\PYG{p}{;}
  \PYG{k+kt}{int} \PYG{n}{pd1}\PYG{o}{=}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{inside}\PYG{p}{(}\PYG{n}{k2}\PYG{p}{),}\PYG{n}{pd2}\PYG{o}{=}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{inside}\PYG{p}{(}\PYG{n}{k3}\PYG{p}{);} 
  \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}}\PYG{n}{A}\PYG{o}{=}\PYG{n}{getCL}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{,}\PYG{n}{k3}\PYG{p}{);}
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{pd1}\PYG{o}{\PYGZgt{}=}\PYG{l+m+mi}{0}\PYG{p}{)\PYGZob{}}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{pd2}\PYG{o}{\PYGZgt{}=}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{return} \PYG{n}{cross}\PYG{p}{(}\PYG{n}{k2}\PYG{p}{,}\PYG{n}{k3}\PYG{p}{)}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{;}
    \PYG{k}{return} \PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{*}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{*}\PYG{n}{rad}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{],}\PYG{n}{k3}\PYG{p}{)}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{k2}\PYG{p}{,}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{])}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{;}
  \PYG{p}{\PYGZcb{}} \PYG{k}{else} \PYG{k}{if} \PYG{p}{(}\PYG{n}{pd2}\PYG{o}{\PYGZgt{}=}\PYG{l+m+mi}{0}\PYG{p}{)\PYGZob{}} 
    \PYG{k}{return} \PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{*}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{*}\PYG{n}{rad}\PYG{p}{(}\PYG{n}{k2}\PYG{p}{,}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{])}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{],}\PYG{n}{k3}\PYG{p}{)}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{;}
  \PYG{p}{\PYGZcb{}}\PYG{k}{else} \PYG{p}{\PYGZob{}}
    \PYG{k+kt}{int} \PYG{n}{pd}\PYG{o}{=}\PYG{n}{cmp}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{p}{,}\PYG{n}{disSP}\PYG{p}{(}\PYG{n}{k2}\PYG{p}{,}\PYG{n}{k3}\PYG{p}{,}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{o}\PYG{p}{));}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{pd}\PYG{o}{\PYGZlt{}=}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{return} \PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{*}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{*}\PYG{n}{rad}\PYG{p}{(}\PYG{n}{k2}\PYG{p}{,}\PYG{n}{k3}\PYG{p}{)}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{;}
    \PYG{k}{return} \PYG{n+nf}{cross}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{],}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{])}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{*}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{*}\PYG{p}{(}\PYG{n}{rad}\PYG{p}{(}\PYG{n}{k2}\PYG{p}{,}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{])}\PYG{o}{+}\PYG{n}{rad}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{],}\PYG{n}{k3}\PYG{p}{))}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{;}
  \PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{}}
\PYG{n}{circle} \PYG{n}{getcircle}\PYG{p}{(}\PYG{n}{point} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k2}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k3}\PYG{p}{)\PYGZob{}}
  \PYG{n}{db} \PYG{n}{a1}\PYG{o}{=}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{x}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,}\PYG{n}{b1}\PYG{o}{=}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{y}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{y}\PYG{p}{,}\PYG{n}{c1}\PYG{o}{=}\PYG{p}{(}\PYG{n}{a1}\PYG{o}{*}\PYG{n}{a1}\PYG{o}{+}\PYG{n}{b1}\PYG{o}{*}\PYG{n}{b1}\PYG{p}{)}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{;}
  \PYG{n}{db} \PYG{n}{a2}\PYG{o}{=}\PYG{n}{k3}\PYG{p}{.}\PYG{n}{x}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,}\PYG{n}{b2}\PYG{o}{=}\PYG{n}{k3}\PYG{p}{.}\PYG{n}{y}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{y}\PYG{p}{,}\PYG{n}{c2}\PYG{o}{=}\PYG{p}{(}\PYG{n}{a2}\PYG{o}{*}\PYG{n}{a2}\PYG{o}{+}\PYG{n}{b2}\PYG{o}{*}\PYG{n}{b2}\PYG{p}{)}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{;}
  \PYG{n}{db} \PYG{n}{d}\PYG{o}{=}\PYG{n}{a1}\PYG{o}{*}\PYG{n}{b2}\PYG{o}{\PYGZhy{}}\PYG{n}{a2}\PYG{o}{*}\PYG{n}{b1}\PYG{p}{;}
  \PYG{n}{point} \PYG{n}{o}\PYG{o}{=}\PYG{p}{(}\PYG{n}{point}\PYG{p}{)\PYGZob{}}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{x}\PYG{o}{+}\PYG{p}{(}\PYG{n}{c1}\PYG{o}{*}\PYG{n}{b2}\PYG{o}{\PYGZhy{}}\PYG{n}{c2}\PYG{o}{*}\PYG{n}{b1}\PYG{p}{)}\PYG{o}{/}\PYG{n}{d}\PYG{p}{,}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{y}\PYG{o}{+}\PYG{p}{(}\PYG{n}{a1}\PYG{o}{*}\PYG{n}{c2}\PYG{o}{\PYGZhy{}}\PYG{n}{a2}\PYG{o}{*}\PYG{n}{c1}\PYG{p}{)}\PYG{o}{/}\PYG{n}{d}\PYG{p}{\PYGZcb{};}
  \PYG{k}{return} \PYG{p}{(}\PYG{n}{circle}\PYG{p}{)\PYGZob{}}\PYG{n}{o}\PYG{p}{,}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{dis}\PYG{p}{(}\PYG{n}{o}\PYG{p}{)\PYGZcb{};}
\PYG{p}{\PYGZcb{}}
\PYG{n}{circle} \PYG{n}{getScircle}\PYG{p}{(}\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}} \PYG{n}{A}\PYG{p}{)\PYGZob{}}
  \PYG{n}{random\PYGZus{}shuffle}\PYG{p}{(}\PYG{n}{A}\PYG{p}{.}\PYG{n}{begin}\PYG{p}{(),}\PYG{n}{A}\PYG{p}{.}\PYG{n}{end}\PYG{p}{());}
  \PYG{n}{circle} \PYG{n}{ans}\PYG{o}{=}\PYG{p}{(}\PYG{n}{circle}\PYG{p}{)\PYGZob{}}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{],}\PYG{l+m+mi}{0}\PYG{p}{\PYGZcb{};}
  \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}}\PYG{n}{A}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{ans}\PYG{p}{.}\PYG{n}{inside}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{])}\PYG{o}{==\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)\PYGZob{}}
      \PYG{n}{ans}\PYG{o}{=}\PYG{p}{(}\PYG{n}{circle}\PYG{p}{)\PYGZob{}}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],}\PYG{l+m+mi}{0}\PYG{p}{\PYGZcb{};}
      \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{j}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{n}{j}\PYG{o}{\PYGZlt{}}\PYG{n}{i}\PYG{p}{;}\PYG{n}{j}\PYG{o}{++}\PYG{p}{)}
        \PYG{k}{if} \PYG{p}{(}\PYG{n}{ans}\PYG{p}{.}\PYG{n}{inside}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{n}{j}\PYG{p}{])}\PYG{o}{==\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)\PYGZob{}}
          \PYG{n}{ans}\PYG{p}{.}\PYG{n}{o}\PYG{o}{=}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{+}\PYG{n}{A}\PYG{p}{[}\PYG{n}{j}\PYG{p}{])}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{;} \PYG{n}{ans}\PYG{p}{.}\PYG{n}{r}\PYG{o}{=}\PYG{n}{ans}\PYG{p}{.}\PYG{n}{o}\PYG{p}{.}\PYG{n}{dis}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]);}
          \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{k}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{n}{k}\PYG{o}{\PYGZlt{}}\PYG{n}{j}\PYG{p}{;}\PYG{n}{k}\PYG{o}{++}\PYG{p}{)}
            \PYG{k}{if} \PYG{p}{(}\PYG{n}{ans}\PYG{p}{.}\PYG{n}{inside}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{n}{k}\PYG{p}{])}\PYG{o}{==\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}
              \PYG{n}{ans}\PYG{o}{=}\PYG{n}{getcircle}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],}\PYG{n}{A}\PYG{p}{[}\PYG{n}{j}\PYG{p}{],}\PYG{n}{A}\PYG{p}{[}\PYG{n}{k}\PYG{p}{]);}
        \PYG{p}{\PYGZcb{}}
    \PYG{p}{\PYGZcb{}}
  \PYG{k}{return} \PYG{n}{ans}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{n}{db} \PYG{n}{area}\PYG{p}{(}\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}} \PYG{n}{A}\PYG{p}{)\PYGZob{}} \PYG{c+c1}{// 多边形用 vector\PYGZlt{}point\PYGZgt{} 表示 , 逆时针 }
  \PYG{n}{db} \PYG{n}{ans}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}
  \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}}\PYG{n}{A}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)} \PYG{n}{ans}\PYG{o}{+=}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],}\PYG{n}{A}\PYG{p}{[(}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{n}{A}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()]);}
  \PYG{k}{return} \PYG{n}{ans}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{k+kt}{int} \PYG{n}{checkconvex}\PYG{p}{(}\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}}\PYG{n}{A}\PYG{p}{)\PYGZob{}}
  \PYG{k+kt}{int} \PYG{n}{n}\PYG{o}{=}\PYG{n}{A}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();} \PYG{n}{A}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]);} \PYG{n}{A}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]);}
  \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}}\PYG{n}{n}\PYG{p}{;}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)} \PYG{k}{if} \PYG{p}{(}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]))}\PYG{o}{==\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)} \PYG{k}{return} \PYG{l+m+mi}{0}\PYG{p}{;}
  \PYG{k}{return} \PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{k+kt}{int} \PYG{n}{contain}\PYG{p}{(}\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}}\PYG{n}{A}\PYG{p}{,}\PYG{n}{point} \PYG{n}{q}\PYG{p}{)\PYGZob{}} \PYG{c+c1}{// 2 内部 1 边界 0 外部}
  \PYG{k+kt}{int} \PYG{n}{pd}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;} \PYG{n}{A}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]);}
  \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}}\PYG{n}{A}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)\PYGZob{}}
    \PYG{n}{point} \PYG{n}{u}\PYG{o}{=}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{],}\PYG{n}{v}\PYG{o}{=}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{];}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{onS}\PYG{p}{(}\PYG{n}{u}\PYG{p}{,}\PYG{n}{v}\PYG{p}{,}\PYG{n}{q}\PYG{p}{))} \PYG{k}{return} \PYG{l+m+mi}{1}\PYG{p}{;} \PYG{k}{if} \PYG{p}{(}\PYG{n}{cmp}\PYG{p}{(}\PYG{n}{u}\PYG{p}{.}\PYG{n}{y}\PYG{p}{,}\PYG{n}{v}\PYG{p}{.}\PYG{n}{y}\PYG{p}{)}\PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{n}{swap}\PYG{p}{(}\PYG{n}{u}\PYG{p}{,}\PYG{n}{v}\PYG{p}{);}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{cmp}\PYG{p}{(}\PYG{n}{u}\PYG{p}{.}\PYG{n}{y}\PYG{p}{,}\PYG{n}{q}\PYG{p}{.}\PYG{n}{y}\PYG{p}{)}\PYG{o}{\PYGZgt{}=}\PYG{l+m+mi}{0}\PYG{o}{||}\PYG{n}{cmp}\PYG{p}{(}\PYG{n}{v}\PYG{p}{.}\PYG{n}{y}\PYG{p}{,}\PYG{n}{q}\PYG{p}{.}\PYG{n}{y}\PYG{p}{)}\PYG{o}{\PYGZlt{}}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{continue}\PYG{p}{;}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{u}\PYG{o}{\PYGZhy{}}\PYG{n}{v}\PYG{p}{,}\PYG{n}{q}\PYG{o}{\PYGZhy{}}\PYG{n}{v}\PYG{p}{))}\PYG{o}{\PYGZlt{}}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{n}{pd}\PYG{o}{\PYGZca{}=}\PYG{l+m+mi}{1}\PYG{p}{;}
  \PYG{p}{\PYGZcb{}}
  \PYG{k}{return} \PYG{n}{pd}\PYG{o}{\PYGZlt{}\PYGZlt{}}\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}} \PYG{n}{ConvexHull}\PYG{p}{(}\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}}\PYG{n}{A}\PYG{p}{,}\PYG{k+kt}{int} \PYG{n}{flag}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)\PYGZob{}} \PYG{c+c1}{// flag=0 不严格 flag=1 严格 }
  \PYG{k+kt}{int} \PYG{n}{n}\PYG{o}{=}\PYG{n}{A}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();} \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}}\PYG{n}{ans}\PYG{p}{(}\PYG{n}{n}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{);} 
  \PYG{n}{sort}\PYG{p}{(}\PYG{n}{A}\PYG{p}{.}\PYG{n}{begin}\PYG{p}{(),}\PYG{n}{A}\PYG{p}{.}\PYG{n}{end}\PYG{p}{());} \PYG{k+kt}{int} \PYG{n}{now}\PYG{o}{=\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{;}
  \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}}\PYG{n}{A}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)\PYGZob{}}
    \PYG{k}{while} \PYG{p}{(}\PYG{n}{now}\PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{0}\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{ans}\PYG{p}{[}\PYG{n}{now}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{ans}\PYG{p}{[}\PYG{n}{now}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{],}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{ans}\PYG{p}{[}\PYG{n}{now}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]))}\PYG{o}{\PYGZlt{}}\PYG{n}{flag}\PYG{p}{)} \PYG{n}{now}\PYG{o}{\PYGZhy{}\PYGZhy{}}\PYG{p}{;}
    \PYG{n}{ans}\PYG{p}{[}\PYG{o}{++}\PYG{n}{now}\PYG{p}{]}\PYG{o}{=}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{];}
  \PYG{p}{\PYGZcb{}} \PYG{k+kt}{int} \PYG{n}{pre}\PYG{o}{=}\PYG{n}{now}\PYG{p}{;}
  \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{n}{n}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZgt{}=}\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZhy{}\PYGZhy{}}\PYG{p}{)\PYGZob{}}
    \PYG{k}{while} \PYG{p}{(}\PYG{n}{now}\PYG{o}{\PYGZgt{}}\PYG{n}{pre}\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{ans}\PYG{p}{[}\PYG{n}{now}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{ans}\PYG{p}{[}\PYG{n}{now}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{],}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{ans}\PYG{p}{[}\PYG{n}{now}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]))}\PYG{o}{\PYGZlt{}}\PYG{n}{flag}\PYG{p}{)} \PYG{n}{now}\PYG{o}{\PYGZhy{}\PYGZhy{}}\PYG{p}{;}
    \PYG{n}{ans}\PYG{p}{[}\PYG{o}{++}\PYG{n}{now}\PYG{p}{]}\PYG{o}{=}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{];}
  \PYG{p}{\PYGZcb{}} \PYG{n}{ans}\PYG{p}{.}\PYG{n}{resize}\PYG{p}{(}\PYG{n}{now}\PYG{p}{);} \PYG{k}{return} \PYG{n}{ans}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{n}{db} \PYG{n}{convexDiameter}\PYG{p}{(}\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}}\PYG{n}{A}\PYG{p}{)\PYGZob{}}
  \PYG{k+kt}{int} \PYG{n}{now}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{n}\PYG{o}{=}\PYG{n}{A}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();} \PYG{n}{db} \PYG{n}{ans}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}
  \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}}\PYG{n}{A}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)\PYGZob{}}
    \PYG{n}{now}\PYG{o}{=}\PYG{n}{max}\PYG{p}{(}\PYG{n}{now}\PYG{p}{,}\PYG{n}{i}\PYG{p}{);}
    \PYG{k}{while} \PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)\PYGZob{}}
      \PYG{n}{db} \PYG{n}{k1}\PYG{o}{=}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{dis}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{n}{now}\PYG{o}{\PYGZpc{}}\PYG{n}{n}\PYG{p}{]),}\PYG{n}{k2}\PYG{o}{=}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{dis}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[(}\PYG{n}{now}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{n}{n}\PYG{p}{]);}
      \PYG{n}{ans}\PYG{o}{=}\PYG{n}{max}\PYG{p}{(}\PYG{n}{ans}\PYG{p}{,}\PYG{n}{max}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{));} \PYG{k}{if} \PYG{p}{(}\PYG{n}{k2}\PYG{o}{\PYGZgt{}}\PYG{n}{k1}\PYG{p}{)} \PYG{n}{now}\PYG{o}{++}\PYG{p}{;} \PYG{k}{else} \PYG{k}{break}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
  \PYG{p}{\PYGZcb{}}
  \PYG{k}{return} \PYG{n}{ans}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}} \PYG{n}{convexcut}\PYG{p}{(}\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}}\PYG{n}{A}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k2}\PYG{p}{)\PYGZob{}}
  \PYG{c+c1}{// 保留 k1,k2,p 逆时针的所有点}
  \PYG{k+kt}{int} \PYG{n}{n}\PYG{o}{=}\PYG{n}{A}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();} \PYG{n}{A}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]);} \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}}\PYG{n}{ans}\PYG{p}{;}
  \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}}\PYG{n}{n}\PYG{p}{;}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)\PYGZob{}}
    \PYG{k+kt}{int} \PYG{n}{w1}\PYG{o}{=}\PYG{n}{clockwise}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{,}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]),}\PYG{n}{w2}\PYG{o}{=}\PYG{n}{clockwise}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{,}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]);}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{w1}\PYG{o}{\PYGZgt{}=}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{n}{ans}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]);}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{w1}\PYG{o}{*}\PYG{n}{w2}\PYG{o}{\PYGZlt{}}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{n}{ans}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{getLL}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{,}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]));}
  \PYG{p}{\PYGZcb{}}
  \PYG{k}{return} \PYG{n}{ans}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{k+kt}{int} \PYG{n}{checkPoS}\PYG{p}{(}\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}}\PYG{n}{A}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k2}\PYG{p}{)\PYGZob{}}
  \PYG{c+c1}{// 多边形 A 和直线 ( 线段 )k1\PYGZhy{}\PYGZgt{}k2 严格相交 , 注释部分为线段}
  \PYG{k}{struct} \PYG{n}{ins}\PYG{p}{\PYGZob{}}
    \PYG{n}{point} \PYG{n}{m}\PYG{p}{,}\PYG{n}{u}\PYG{p}{,}\PYG{n}{v}\PYG{p}{;}
    \PYG{k+kt}{int} \PYG{k}{operator} \PYG{o}{\PYGZlt{}} \PYG{p}{(}\PYG{k}{const} \PYG{n}{ins}\PYG{o}{\PYGZam{}} \PYG{n}{k}\PYG{p}{)} \PYG{k}{const} \PYG{p}{\PYGZob{}}\PYG{k}{return} \PYG{n}{m}\PYG{o}{\PYGZlt{}}\PYG{n}{k}\PYG{p}{.}\PYG{n}{m}\PYG{p}{;\PYGZcb{}}
  \PYG{p}{\PYGZcb{};} \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{ins}\PYG{o}{\PYGZgt{}}\PYG{n}{B}\PYG{p}{;}
  \PYG{c+c1}{//if (contain(A,k1)==2||contain(A,k2)==2) return 1;}
  \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}}\PYG{n}{poly}\PYG{o}{=}\PYG{n}{A}\PYG{p}{;} \PYG{n}{A}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]);} 
  \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}}\PYG{n}{A}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)} \PYG{k}{if} \PYG{p}{(}\PYG{n}{checkLL}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{],}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{))\PYGZob{}}
    \PYG{n}{point} \PYG{n}{m}\PYG{o}{=}\PYG{n}{getLL}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{],}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{);} 
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{inmid}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{],}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],}\PYG{n}{m}\PYG{p}{)}\PYG{c+cm}{/*\PYGZam{}\PYGZam{}inmid(k1,k2,m)*/}\PYG{p}{)} \PYG{n}{B}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{((}\PYG{n}{ins}\PYG{p}{)\PYGZob{}}\PYG{n}{m}\PYG{p}{,}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{],}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]\PYGZcb{});}
  \PYG{p}{\PYGZcb{}}
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{B}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{return} \PYG{l+m+mi}{0}\PYG{p}{;} \PYG{n}{sort}\PYG{p}{(}\PYG{n}{B}\PYG{p}{.}\PYG{n}{begin}\PYG{p}{(),}\PYG{n}{B}\PYG{p}{.}\PYG{n}{end}\PYG{p}{());} 
  \PYG{k+kt}{int} \PYG{n}{now}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{;} \PYG{k}{while} \PYG{p}{(}\PYG{n}{now}\PYG{o}{\PYGZlt{}}\PYG{n}{B}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{n}{B}\PYG{p}{[}\PYG{n}{now}\PYG{p}{].}\PYG{n}{m}\PYG{o}{==}\PYG{n}{B}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{].}\PYG{n}{m}\PYG{p}{)} \PYG{n}{now}\PYG{o}{++}\PYG{p}{;} 
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{now}\PYG{o}{==}\PYG{n}{B}\PYG{p}{.}\PYG{n}{size}\PYG{p}{())} \PYG{k}{return} \PYG{l+m+mi}{0}\PYG{p}{;}
  \PYG{k+kt}{int} \PYG{n}{flag}\PYG{o}{=}\PYG{n}{contain}\PYG{p}{(}\PYG{n}{poly}\PYG{p}{,(}\PYG{n}{B}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{].}\PYG{n}{m}\PYG{o}{+}\PYG{n}{B}\PYG{p}{[}\PYG{n}{now}\PYG{p}{].}\PYG{n}{m}\PYG{p}{)}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{);}
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{flag}\PYG{o}{==}\PYG{l+m+mi}{2}\PYG{p}{)} \PYG{k}{return} \PYG{l+m+mi}{1}\PYG{p}{;}
  \PYG{n}{point} \PYG{n}{d}\PYG{o}{=}\PYG{n}{B}\PYG{p}{[}\PYG{n}{now}\PYG{p}{].}\PYG{n}{m}\PYG{o}{\PYGZhy{}}\PYG{n}{B}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{].}\PYG{n}{m}\PYG{p}{;}
  \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{n}{now}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}}\PYG{n}{B}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)\PYGZob{}}
    \PYG{k}{if} \PYG{p}{(}\PYG{o}{!}\PYG{p}{(}\PYG{n}{B}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{m}\PYG{o}{==}\PYG{n}{B}\PYG{p}{[}\PYG{n}{i}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{].}\PYG{n}{m}\PYG{p}{)}\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{n}{flag}\PYG{o}{==}\PYG{l+m+mi}{2}\PYG{p}{)} \PYG{k}{return} \PYG{l+m+mi}{1}\PYG{p}{;}
    \PYG{k+kt}{int} \PYG{n}{tag}\PYG{o}{=}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{B}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{v}\PYG{o}{\PYGZhy{}}\PYG{n}{B}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{u}\PYG{p}{,}\PYG{n}{B}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{m}\PYG{o}{+}\PYG{n}{d}\PYG{o}{\PYGZhy{}}\PYG{n}{B}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{u}\PYG{p}{));}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{B}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{m}\PYG{o}{==}\PYG{n}{B}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{u}\PYG{o}{||}\PYG{n}{B}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{m}\PYG{o}{==}\PYG{n}{B}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{v}\PYG{p}{)} \PYG{n}{flag}\PYG{o}{+=}\PYG{n}{tag}\PYG{p}{;} \PYG{k}{else} \PYG{n}{flag}\PYG{o}{+=}\PYG{n}{tag}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{;}
  \PYG{p}{\PYGZcb{}}
  \PYG{c+c1}{//return 0;}
  \PYG{k}{return} \PYG{n}{flag}\PYG{o}{==}\PYG{l+m+mi}{2}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{k+kt}{int} \PYG{n}{checkinp}\PYG{p}{(}\PYG{n}{point} \PYG{n}{r}\PYG{p}{,}\PYG{n}{point} \PYG{n}{l}\PYG{p}{,}\PYG{n}{point} \PYG{n}{m}\PYG{p}{)\PYGZob{}}
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{compareangle}\PYG{p}{(}\PYG{n}{l}\PYG{p}{,}\PYG{n}{r}\PYG{p}{))\PYGZob{}}\PYG{k}{return} \PYG{n}{compareangle}\PYG{p}{(}\PYG{n}{l}\PYG{p}{,}\PYG{n}{m}\PYG{p}{)}\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{n}{compareangle}\PYG{p}{(}\PYG{n}{m}\PYG{p}{,}\PYG{n}{r}\PYG{p}{);\PYGZcb{}}
  \PYG{k}{return} \PYG{n}{compareangle}\PYG{p}{(}\PYG{n}{l}\PYG{p}{,}\PYG{n}{m}\PYG{p}{)}\PYG{o}{||}\PYG{n}{compareangle}\PYG{p}{(}\PYG{n}{m}\PYG{p}{,}\PYG{n}{r}\PYG{p}{);}
\PYG{p}{\PYGZcb{}}
\PYG{k+kt}{int} \PYG{n}{checkPosFast}\PYG{p}{(}\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}}\PYG{n}{A}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k2}\PYG{p}{)\PYGZob{}} \PYG{c+c1}{// 快速检查线段是否和多边形严格相交}
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{contain}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,}\PYG{n}{k1}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{2}\PYG{o}{||}\PYG{n}{contain}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{2}\PYG{p}{)} \PYG{k}{return} \PYG{l+m+mi}{1}\PYG{p}{;} \PYG{k}{if} \PYG{p}{(}\PYG{n}{k1}\PYG{o}{==}\PYG{n}{k2}\PYG{p}{)} \PYG{k}{return} \PYG{l+m+mi}{0}\PYG{p}{;}
  \PYG{n}{A}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]);} \PYG{n}{A}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]);}
  \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{o}{\PYGZlt{}}\PYG{n}{A}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{checkLL}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{],}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{))\PYGZob{}}
      \PYG{n}{point} \PYG{n}{now}\PYG{o}{=}\PYG{n}{getLL}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{],}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{);}
      \PYG{k}{if} \PYG{p}{(}\PYG{n}{inmid}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{],}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],}\PYG{n}{now}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{o}{||}\PYG{n}{inmid}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{,}\PYG{n}{now}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{continue}\PYG{p}{;}
      \PYG{k}{if} \PYG{p}{(}\PYG{n}{now}\PYG{o}{==}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{])\PYGZob{}}
        \PYG{k}{if} \PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{==}\PYG{n}{k2}\PYG{p}{)} \PYG{k}{continue}\PYG{p}{;}
        \PYG{n}{point} \PYG{n}{pre}\PYG{o}{=}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{],}\PYG{n}{ne}\PYG{o}{=}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{];}
        \PYG{k}{if} \PYG{p}{(}\PYG{n}{checkinp}\PYG{p}{(}\PYG{n}{pre}\PYG{o}{\PYGZhy{}}\PYG{n}{now}\PYG{p}{,}\PYG{n}{ne}\PYG{o}{\PYGZhy{}}\PYG{n}{now}\PYG{p}{,}\PYG{n}{k2}\PYG{o}{\PYGZhy{}}\PYG{n}{now}\PYG{p}{))} \PYG{k}{return} \PYG{l+m+mi}{1}\PYG{p}{;}
      \PYG{p}{\PYGZcb{}} \PYG{k}{else} \PYG{k}{if} \PYG{p}{(}\PYG{n}{now}\PYG{o}{==}\PYG{n}{k1}\PYG{p}{)\PYGZob{}}
        \PYG{k}{if} \PYG{p}{(}\PYG{n}{k1}\PYG{o}{==}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{||}\PYG{n}{k1}\PYG{o}{==}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{])} \PYG{k}{continue}\PYG{p}{;}
        \PYG{k}{if} \PYG{p}{(}\PYG{n}{checkinp}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{))} \PYG{k}{return} \PYG{l+m+mi}{1}\PYG{p}{;}
      \PYG{p}{\PYGZcb{}} \PYG{k}{else} \PYG{k}{if} \PYG{p}{(}\PYG{n}{now}\PYG{o}{==}\PYG{n}{k2}\PYG{o}{||}\PYG{n}{now}\PYG{o}{==}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{])} \PYG{k}{continue}\PYG{p}{;}
      \PYG{k}{else} \PYG{k}{return} \PYG{l+m+mi}{1}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
  \PYG{k}{return} \PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{// 拆分凸包成上下凸壳 凸包尽量都随机旋转一个角度来避免出现相同横坐标 }
\PYG{c+c1}{// 尽量特判只有一个点的情况 凸包逆时针}
\PYG{k+kt}{void} \PYG{n}{getUDP}\PYG{p}{(}\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}}\PYG{n}{A}\PYG{p}{,}\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}\PYGZam{}}\PYG{n}{U}\PYG{p}{,}\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}\PYGZam{}}\PYG{n}{D}\PYG{p}{)\PYGZob{}}
  \PYG{n}{db} \PYG{n}{l}\PYG{o}{=}\PYG{l+m+mf}{1e100}\PYG{p}{,}\PYG{n}{r}\PYG{o}{=\PYGZhy{}}\PYG{l+m+mf}{1e100}\PYG{p}{;}
  \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}}\PYG{n}{A}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)} \PYG{n}{l}\PYG{o}{=}\PYG{n}{min}\PYG{p}{(}\PYG{n}{l}\PYG{p}{,}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{x}\PYG{p}{),}\PYG{n}{r}\PYG{o}{=}\PYG{n}{max}\PYG{p}{(}\PYG{n}{r}\PYG{p}{,}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{x}\PYG{p}{);}
  \PYG{k+kt}{int} \PYG{n}{wherel}\PYG{p}{,}\PYG{n}{wherer}\PYG{p}{;}
  \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}}\PYG{n}{A}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)} \PYG{k}{if} \PYG{p}{(}\PYG{n}{cmp}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{x}\PYG{p}{,}\PYG{n}{l}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{n}{wherel}\PYG{o}{=}\PYG{n}{i}\PYG{p}{;}
  \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{n}{A}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}\PYG{n}{i}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZhy{}\PYGZhy{}}\PYG{p}{)} \PYG{k}{if} \PYG{p}{(}\PYG{n}{cmp}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{].}\PYG{n}{x}\PYG{p}{,}\PYG{n}{r}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{n}{wherer}\PYG{o}{=}\PYG{n}{i}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{;}
  \PYG{n}{U}\PYG{p}{.}\PYG{n}{clear}\PYG{p}{();} \PYG{n}{D}\PYG{p}{.}\PYG{n}{clear}\PYG{p}{();} \PYG{k+kt}{int} \PYG{n}{now}\PYG{o}{=}\PYG{n}{wherel}\PYG{p}{;}
  \PYG{k}{while} \PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)\PYGZob{}}\PYG{n}{D}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{n}{now}\PYG{p}{]);} \PYG{k}{if} \PYG{p}{(}\PYG{n}{now}\PYG{o}{==}\PYG{n}{wherer}\PYG{p}{)} \PYG{k}{break}\PYG{p}{;} \PYG{n}{now}\PYG{o}{++}\PYG{p}{;} \PYG{k}{if} \PYG{p}{(}\PYG{n}{now}\PYG{o}{\PYGZgt{}=}\PYG{n}{A}\PYG{p}{.}\PYG{n}{size}\PYG{p}{())} \PYG{n}{now}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;\PYGZcb{}}
  \PYG{n}{now}\PYG{o}{=}\PYG{n}{wherel}\PYG{p}{;}
  \PYG{k}{while} \PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)\PYGZob{}}\PYG{n}{U}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{n}{now}\PYG{p}{]);} \PYG{k}{if} \PYG{p}{(}\PYG{n}{now}\PYG{o}{==}\PYG{n}{wherer}\PYG{p}{)} \PYG{k}{break}\PYG{p}{;} \PYG{n}{now}\PYG{o}{\PYGZhy{}\PYGZhy{}}\PYG{p}{;} \PYG{k}{if} \PYG{p}{(}\PYG{n}{now}\PYG{o}{\PYGZlt{}}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{n}{now}\PYG{o}{=}\PYG{n}{A}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{;\PYGZcb{}}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{// 需要保证凸包点数大于等于 3,2 内部 ,1 边界 ,0 外部}
\PYG{k+kt}{int} \PYG{n}{containCoP}\PYG{p}{(}\PYG{k}{const} \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}\PYGZam{}}\PYG{n}{U}\PYG{p}{,}\PYG{k}{const} \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}\PYGZam{}}\PYG{n}{D}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k}\PYG{p}{)\PYGZob{}}
  \PYG{n}{db} \PYG{n}{lx}\PYG{o}{=}\PYG{n}{U}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{].}\PYG{n}{x}\PYG{p}{,}\PYG{n}{rx}\PYG{o}{=}\PYG{n}{U}\PYG{p}{[}\PYG{n}{U}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{].}\PYG{n}{x}\PYG{p}{;}
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{k}\PYG{o}{==}\PYG{n}{U}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{||}\PYG{n}{k}\PYG{o}{==}\PYG{n}{U}\PYG{p}{[}\PYG{n}{U}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{])} \PYG{k}{return} \PYG{l+m+mi}{1}\PYG{p}{;}
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{cmp}\PYG{p}{(}\PYG{n}{k}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,}\PYG{n}{lx}\PYG{p}{)}\PYG{o}{==\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{o}{||}\PYG{n}{cmp}\PYG{p}{(}\PYG{n}{k}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,}\PYG{n}{rx}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{1}\PYG{p}{)} \PYG{k}{return} \PYG{l+m+mi}{0}\PYG{p}{;}
  \PYG{k+kt}{int} \PYG{n}{where1}\PYG{o}{=}\PYG{n}{lower\PYGZus{}bound}\PYG{p}{(}\PYG{n}{U}\PYG{p}{.}\PYG{n}{begin}\PYG{p}{(),}\PYG{n}{U}\PYG{p}{.}\PYG{n}{end}\PYG{p}{(),(}\PYG{n}{point}\PYG{p}{)\PYGZob{}}\PYG{n}{k}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1e100}\PYG{p}{\PYGZcb{})}\PYG{o}{\PYGZhy{}}\PYG{n}{U}\PYG{p}{.}\PYG{n}{begin}\PYG{p}{();}
  \PYG{k+kt}{int} \PYG{n}{where2}\PYG{o}{=}\PYG{n}{lower\PYGZus{}bound}\PYG{p}{(}\PYG{n}{D}\PYG{p}{.}\PYG{n}{begin}\PYG{p}{(),}\PYG{n}{D}\PYG{p}{.}\PYG{n}{end}\PYG{p}{(),(}\PYG{n}{point}\PYG{p}{)\PYGZob{}}\PYG{n}{k}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1e100}\PYG{p}{\PYGZcb{})}\PYG{o}{\PYGZhy{}}\PYG{n}{D}\PYG{p}{.}\PYG{n}{begin}\PYG{p}{();}
  \PYG{k+kt}{int} \PYG{n}{w1}\PYG{o}{=}\PYG{n}{clockwise}\PYG{p}{(}\PYG{n}{U}\PYG{p}{[}\PYG{n}{where1}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{],}\PYG{n}{U}\PYG{p}{[}\PYG{n}{where1}\PYG{p}{],}\PYG{n}{k}\PYG{p}{),}\PYG{n}{w2}\PYG{o}{=}\PYG{n}{clockwise}\PYG{p}{(}\PYG{n}{D}\PYG{p}{[}\PYG{n}{where2}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{],}\PYG{n}{D}\PYG{p}{[}\PYG{n}{where2}\PYG{p}{],}\PYG{n}{k}\PYG{p}{);}
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{w1}\PYG{o}{==}\PYG{l+m+mi}{1}\PYG{o}{||}\PYG{n}{w2}\PYG{o}{==\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)} \PYG{k}{return} \PYG{l+m+mi}{0}\PYG{p}{;} \PYG{k}{else} \PYG{n+nf}{if} \PYG{p}{(}\PYG{n}{w1}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{o}{||}\PYG{n}{w2}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{return} \PYG{l+m+mi}{1}\PYG{p}{;} \PYG{k}{return} \PYG{l+m+mi}{2}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{// d 是方向 , 输出上方切点和下方切点}
\PYG{n}{pair}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{p}{,}\PYG{n}{point}\PYG{o}{\PYGZgt{}} \PYG{n}{getTangentCow}\PYG{p}{(}\PYG{k}{const} \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}} \PYG{o}{\PYGZam{}}\PYG{n}{U}\PYG{p}{,}\PYG{k}{const} \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}} \PYG{o}{\PYGZam{}}\PYG{n}{D}\PYG{p}{,}\PYG{n}{point} \PYG{n}{d}\PYG{p}{)\PYGZob{}}
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{d}\PYG{p}{.}\PYG{n}{x}\PYG{p}{)}\PYG{o}{\PYGZlt{}}\PYG{l+m+mi}{0}\PYG{o}{||}\PYG{p}{(}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{d}\PYG{p}{.}\PYG{n}{x}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{d}\PYG{p}{.}\PYG{n}{y}\PYG{p}{)}\PYG{o}{\PYGZlt{}}\PYG{l+m+mi}{0}\PYG{p}{))} \PYG{n}{d}\PYG{o}{=}\PYG{n}{d}\PYG{o}{*}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{);}
  \PYG{n}{point} \PYG{n}{whereU}\PYG{p}{,}\PYG{n}{whereD}\PYG{p}{;}
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{d}\PYG{p}{.}\PYG{n}{x}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{return} \PYG{n}{mp}\PYG{p}{(}\PYG{n}{U}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{],}\PYG{n}{U}\PYG{p}{[}\PYG{n}{U}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]);}
  \PYG{k+kt}{int} \PYG{n}{l}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{r}\PYG{o}{=}\PYG{n}{U}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{ans}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}
  \PYG{k}{while} \PYG{p}{(}\PYG{n}{l}\PYG{o}{\PYGZlt{}}\PYG{n}{r}\PYG{p}{)\PYGZob{}}\PYG{k+kt}{int} \PYG{n}{mid}\PYG{o}{=}\PYG{n}{l}\PYG{o}{+}\PYG{n}{r}\PYG{o}{\PYGZgt{}\PYGZgt{}}\PYG{l+m+mi}{1}\PYG{p}{;} \PYG{k}{if} \PYG{p}{(}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{U}\PYG{p}{[}\PYG{n}{mid}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{U}\PYG{p}{[}\PYG{n}{mid}\PYG{p}{],}\PYG{n}{d}\PYG{p}{))}\PYG{o}{\PYGZlt{}=}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{n}{l}\PYG{o}{=}\PYG{n}{mid}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{ans}\PYG{o}{=}\PYG{n}{mid}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{;} \PYG{k}{else} \PYG{n}{r}\PYG{o}{=}\PYG{n}{mid}\PYG{p}{;\PYGZcb{}}
  \PYG{n}{whereU}\PYG{o}{=}\PYG{n}{U}\PYG{p}{[}\PYG{n}{ans}\PYG{p}{];} \PYG{n}{l}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{r}\PYG{o}{=}\PYG{n}{D}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{ans}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}
  \PYG{k}{while} \PYG{p}{(}\PYG{n}{l}\PYG{o}{\PYGZlt{}}\PYG{n}{r}\PYG{p}{)\PYGZob{}}\PYG{k+kt}{int} \PYG{n}{mid}\PYG{o}{=}\PYG{n}{l}\PYG{o}{+}\PYG{n}{r}\PYG{o}{\PYGZgt{}\PYGZgt{}}\PYG{l+m+mi}{1}\PYG{p}{;} \PYG{k}{if} \PYG{p}{(}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{D}\PYG{p}{[}\PYG{n}{mid}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{D}\PYG{p}{[}\PYG{n}{mid}\PYG{p}{],}\PYG{n}{d}\PYG{p}{))}\PYG{o}{\PYGZgt{}=}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{n}{l}\PYG{o}{=}\PYG{n}{mid}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{ans}\PYG{o}{=}\PYG{n}{mid}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{;} \PYG{k}{else} \PYG{n}{r}\PYG{o}{=}\PYG{n}{mid}\PYG{p}{;\PYGZcb{}}
  \PYG{n}{whereD}\PYG{o}{=}\PYG{n}{D}\PYG{p}{[}\PYG{n}{ans}\PYG{p}{];} \PYG{k}{return} \PYG{n+nf}{mp}\PYG{p}{(}\PYG{n}{whereU}\PYG{p}{,}\PYG{n}{whereD}\PYG{p}{);}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{// 先检查 contain, 逆时针给出}
\PYG{n}{pair}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{p}{,}\PYG{n}{point}\PYG{o}{\PYGZgt{}} \PYG{n}{getTangentCoP}\PYG{p}{(}\PYG{k}{const} \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}\PYGZam{}}\PYG{n}{U}\PYG{p}{,}\PYG{k}{const} \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}\PYGZam{}}\PYG{n}{D}\PYG{p}{,}\PYG{n}{point} \PYG{n}{k}\PYG{p}{)\PYGZob{}}
  \PYG{n}{db} \PYG{n}{lx}\PYG{o}{=}\PYG{n}{U}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{].}\PYG{n}{x}\PYG{p}{,}\PYG{n}{rx}\PYG{o}{=}\PYG{n}{U}\PYG{p}{[}\PYG{n}{U}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{].}\PYG{n}{x}\PYG{p}{;}
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{k}\PYG{p}{.}\PYG{n}{x}\PYG{o}{\PYGZlt{}}\PYG{n}{lx}\PYG{p}{)\PYGZob{}}
    \PYG{k+kt}{int} \PYG{n}{l}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{r}\PYG{o}{=}\PYG{n}{U}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{ans}\PYG{o}{=}\PYG{n}{U}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{;}
    \PYG{k}{while} \PYG{p}{(}\PYG{n}{l}\PYG{o}{\PYGZlt{}}\PYG{n}{r}\PYG{p}{)\PYGZob{}}\PYG{k+kt}{int} \PYG{n}{mid}\PYG{o}{=}\PYG{n}{l}\PYG{o}{+}\PYG{n}{r}\PYG{o}{\PYGZgt{}\PYGZgt{}}\PYG{l+m+mi}{1}\PYG{p}{;} \PYG{k}{if} \PYG{p}{(}\PYG{n}{clockwise}\PYG{p}{(}\PYG{n}{k}\PYG{p}{,}\PYG{n}{U}\PYG{p}{[}\PYG{n}{mid}\PYG{p}{],}\PYG{n}{U}\PYG{p}{[}\PYG{n}{mid}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{])}\PYG{o}{==}\PYG{l+m+mi}{1}\PYG{p}{)} \PYG{n}{l}\PYG{o}{=}\PYG{n}{mid}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{;} \PYG{k}{else} \PYG{n}{ans}\PYG{o}{=}\PYG{n}{mid}\PYG{p}{,}\PYG{n}{r}\PYG{o}{=}\PYG{n}{mid}\PYG{p}{;\PYGZcb{}}
    \PYG{n}{point} \PYG{n}{w1}\PYG{o}{=}\PYG{n}{U}\PYG{p}{[}\PYG{n}{ans}\PYG{p}{];} \PYG{n}{l}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{r}\PYG{o}{=}\PYG{n}{D}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{ans}\PYG{o}{=}\PYG{n}{D}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{;}
    \PYG{k}{while} \PYG{p}{(}\PYG{n}{l}\PYG{o}{\PYGZlt{}}\PYG{n}{r}\PYG{p}{)\PYGZob{}}\PYG{k+kt}{int} \PYG{n}{mid}\PYG{o}{=}\PYG{n}{l}\PYG{o}{+}\PYG{n}{r}\PYG{o}{\PYGZgt{}\PYGZgt{}}\PYG{l+m+mi}{1}\PYG{p}{;} \PYG{k}{if} \PYG{p}{(}\PYG{n}{clockwise}\PYG{p}{(}\PYG{n}{k}\PYG{p}{,}\PYG{n}{D}\PYG{p}{[}\PYG{n}{mid}\PYG{p}{],}\PYG{n}{D}\PYG{p}{[}\PYG{n}{mid}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{])}\PYG{o}{==\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)} \PYG{n}{l}\PYG{o}{=}\PYG{n}{mid}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{;} \PYG{k}{else} \PYG{n}{ans}\PYG{o}{=}\PYG{n}{mid}\PYG{p}{,}\PYG{n}{r}\PYG{o}{=}\PYG{n}{mid}\PYG{p}{;\PYGZcb{}}
    \PYG{n}{point} \PYG{n}{w2}\PYG{o}{=}\PYG{n}{D}\PYG{p}{[}\PYG{n}{ans}\PYG{p}{];} \PYG{k}{return} \PYG{n+nf}{mp}\PYG{p}{(}\PYG{n}{w1}\PYG{p}{,}\PYG{n}{w2}\PYG{p}{);}
  \PYG{p}{\PYGZcb{}} \PYG{k}{else} \PYG{k}{if} \PYG{p}{(}\PYG{n}{k}\PYG{p}{.}\PYG{n}{x}\PYG{o}{\PYGZgt{}}\PYG{n}{rx}\PYG{p}{)\PYGZob{}}
    \PYG{k+kt}{int} \PYG{n}{l}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{r}\PYG{o}{=}\PYG{n}{U}\PYG{p}{.}\PYG{n}{size}\PYG{p}{(),}\PYG{n}{ans}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}
    \PYG{k}{while} \PYG{p}{(}\PYG{n}{l}\PYG{o}{\PYGZlt{}}\PYG{n}{r}\PYG{p}{)\PYGZob{}}\PYG{k+kt}{int} \PYG{n}{mid}\PYG{o}{=}\PYG{n}{l}\PYG{o}{+}\PYG{n}{r}\PYG{o}{\PYGZgt{}\PYGZgt{}}\PYG{l+m+mi}{1}\PYG{p}{;} \PYG{k}{if} \PYG{p}{(}\PYG{n}{clockwise}\PYG{p}{(}\PYG{n}{k}\PYG{p}{,}\PYG{n}{U}\PYG{p}{[}\PYG{n}{mid}\PYG{p}{],}\PYG{n}{U}\PYG{p}{[}\PYG{n}{mid}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{])}\PYG{o}{==\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)} \PYG{n}{r}\PYG{o}{=}\PYG{n}{mid}\PYG{p}{;} \PYG{k}{else} \PYG{n}{ans}\PYG{o}{=}\PYG{n}{mid}\PYG{p}{,}\PYG{n}{l}\PYG{o}{=}\PYG{n}{mid}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{;\PYGZcb{}}
    \PYG{n}{point} \PYG{n}{w1}\PYG{o}{=}\PYG{n}{U}\PYG{p}{[}\PYG{n}{ans}\PYG{p}{];} \PYG{n}{l}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{r}\PYG{o}{=}\PYG{n}{D}\PYG{p}{.}\PYG{n}{size}\PYG{p}{(),}\PYG{n}{ans}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}
    \PYG{k}{while} \PYG{p}{(}\PYG{n}{l}\PYG{o}{\PYGZlt{}}\PYG{n}{r}\PYG{p}{)\PYGZob{}}\PYG{k+kt}{int} \PYG{n}{mid}\PYG{o}{=}\PYG{n}{l}\PYG{o}{+}\PYG{n}{r}\PYG{o}{\PYGZgt{}\PYGZgt{}}\PYG{l+m+mi}{1}\PYG{p}{;} \PYG{k}{if} \PYG{p}{(}\PYG{n}{clockwise}\PYG{p}{(}\PYG{n}{k}\PYG{p}{,}\PYG{n}{D}\PYG{p}{[}\PYG{n}{mid}\PYG{p}{],}\PYG{n}{D}\PYG{p}{[}\PYG{n}{mid}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{])}\PYG{o}{==}\PYG{l+m+mi}{1}\PYG{p}{)} \PYG{n}{r}\PYG{o}{=}\PYG{n}{mid}\PYG{p}{;} \PYG{k}{else} \PYG{n}{ans}\PYG{o}{=}\PYG{n}{mid}\PYG{p}{,}\PYG{n}{l}\PYG{o}{=}\PYG{n}{mid}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{;\PYGZcb{}}
    \PYG{n}{point} \PYG{n}{w2}\PYG{o}{=}\PYG{n}{D}\PYG{p}{[}\PYG{n}{ans}\PYG{p}{];} \PYG{k}{return} \PYG{n+nf}{mp}\PYG{p}{(}\PYG{n}{w2}\PYG{p}{,}\PYG{n}{w1}\PYG{p}{);}
  \PYG{p}{\PYGZcb{}} \PYG{k}{else} \PYG{p}{\PYGZob{}}
    \PYG{k+kt}{int} \PYG{n}{where1}\PYG{o}{=}\PYG{n}{lower\PYGZus{}bound}\PYG{p}{(}\PYG{n}{U}\PYG{p}{.}\PYG{n}{begin}\PYG{p}{(),}\PYG{n}{U}\PYG{p}{.}\PYG{n}{end}\PYG{p}{(),(}\PYG{n}{point}\PYG{p}{)\PYGZob{}}\PYG{n}{k}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1e100}\PYG{p}{\PYGZcb{})}\PYG{o}{\PYGZhy{}}\PYG{n}{U}\PYG{p}{.}\PYG{n}{begin}\PYG{p}{();}
    \PYG{k+kt}{int} \PYG{n}{where2}\PYG{o}{=}\PYG{n}{lower\PYGZus{}bound}\PYG{p}{(}\PYG{n}{D}\PYG{p}{.}\PYG{n}{begin}\PYG{p}{(),}\PYG{n}{D}\PYG{p}{.}\PYG{n}{end}\PYG{p}{(),(}\PYG{n}{point}\PYG{p}{)\PYGZob{}}\PYG{n}{k}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1e100}\PYG{p}{\PYGZcb{})}\PYG{o}{\PYGZhy{}}\PYG{n}{D}\PYG{p}{.}\PYG{n}{begin}\PYG{p}{();}
    \PYG{k}{if} \PYG{p}{((}\PYG{n}{k}\PYG{p}{.}\PYG{n}{x}\PYG{o}{==}\PYG{n}{lx}\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{n}{k}\PYG{p}{.}\PYG{n}{y}\PYG{o}{\PYGZgt{}}\PYG{n}{U}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{].}\PYG{n}{y}\PYG{p}{)}\PYG{o}{||}\PYG{p}{(}\PYG{n}{where1}\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{n}{clockwise}\PYG{p}{(}\PYG{n}{U}\PYG{p}{[}\PYG{n}{where1}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{],}\PYG{n}{U}\PYG{p}{[}\PYG{n}{where1}\PYG{p}{],}\PYG{n}{k}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{1}\PYG{p}{))\PYGZob{}}
      \PYG{k+kt}{int} \PYG{n}{l}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{r}\PYG{o}{=}\PYG{n}{where1}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{ans}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}
      \PYG{k}{while} \PYG{p}{(}\PYG{n}{l}\PYG{o}{\PYGZlt{}}\PYG{n}{r}\PYG{p}{)\PYGZob{}}\PYG{k+kt}{int} \PYG{n}{mid}\PYG{o}{=}\PYG{n}{l}\PYG{o}{+}\PYG{n}{r}\PYG{o}{\PYGZgt{}\PYGZgt{}}\PYG{l+m+mi}{1}\PYG{p}{;} \PYG{k}{if} \PYG{p}{(}\PYG{n}{clockwise}\PYG{p}{(}\PYG{n}{k}\PYG{p}{,}\PYG{n}{U}\PYG{p}{[}\PYG{n}{mid}\PYG{p}{],}\PYG{n}{U}\PYG{p}{[}\PYG{n}{mid}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{])}\PYG{o}{==}\PYG{l+m+mi}{1}\PYG{p}{)} \PYG{n}{ans}\PYG{o}{=}\PYG{n}{mid}\PYG{p}{,}\PYG{n}{l}\PYG{o}{=}\PYG{n}{mid}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{;} \PYG{k}{else} \PYG{n}{r}\PYG{o}{=}\PYG{n}{mid}\PYG{p}{;\PYGZcb{}}
      \PYG{n}{point} \PYG{n}{w1}\PYG{o}{=}\PYG{n}{U}\PYG{p}{[}\PYG{n}{ans}\PYG{p}{];} \PYG{n}{l}\PYG{o}{=}\PYG{n}{where1}\PYG{p}{,}\PYG{n}{r}\PYG{o}{=}\PYG{n}{U}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{ans}\PYG{o}{=}\PYG{n}{U}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{;}
      \PYG{k}{while} \PYG{p}{(}\PYG{n}{l}\PYG{o}{\PYGZlt{}}\PYG{n}{r}\PYG{p}{)\PYGZob{}}\PYG{k+kt}{int} \PYG{n}{mid}\PYG{o}{=}\PYG{n}{l}\PYG{o}{+}\PYG{n}{r}\PYG{o}{\PYGZgt{}\PYGZgt{}}\PYG{l+m+mi}{1}\PYG{p}{;} \PYG{k}{if} \PYG{p}{(}\PYG{n}{clockwise}\PYG{p}{(}\PYG{n}{k}\PYG{p}{,}\PYG{n}{U}\PYG{p}{[}\PYG{n}{mid}\PYG{p}{],}\PYG{n}{U}\PYG{p}{[}\PYG{n}{mid}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{])}\PYG{o}{==}\PYG{l+m+mi}{1}\PYG{p}{)} \PYG{n}{l}\PYG{o}{=}\PYG{n}{mid}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{;} \PYG{k}{else} \PYG{n}{ans}\PYG{o}{=}\PYG{n}{mid}\PYG{p}{,}\PYG{n}{r}\PYG{o}{=}\PYG{n}{mid}\PYG{p}{;\PYGZcb{}}
      \PYG{n}{point} \PYG{n}{w2}\PYG{o}{=}\PYG{n}{U}\PYG{p}{[}\PYG{n}{ans}\PYG{p}{];} \PYG{k}{return} \PYG{n+nf}{mp}\PYG{p}{(}\PYG{n}{w2}\PYG{p}{,}\PYG{n}{w1}\PYG{p}{);}
    \PYG{p}{\PYGZcb{}} \PYG{k}{else} \PYG{p}{\PYGZob{}}
      \PYG{k+kt}{int} \PYG{n}{l}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{r}\PYG{o}{=}\PYG{n}{where2}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{ans}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}
      \PYG{k}{while} \PYG{p}{(}\PYG{n}{l}\PYG{o}{\PYGZlt{}}\PYG{n}{r}\PYG{p}{)\PYGZob{}}\PYG{k+kt}{int} \PYG{n}{mid}\PYG{o}{=}\PYG{n}{l}\PYG{o}{+}\PYG{n}{r}\PYG{o}{\PYGZgt{}\PYGZgt{}}\PYG{l+m+mi}{1}\PYG{p}{;} \PYG{k}{if} \PYG{p}{(}\PYG{n}{clockwise}\PYG{p}{(}\PYG{n}{k}\PYG{p}{,}\PYG{n}{D}\PYG{p}{[}\PYG{n}{mid}\PYG{p}{],}\PYG{n}{D}\PYG{p}{[}\PYG{n}{mid}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{])}\PYG{o}{==\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)} \PYG{n}{ans}\PYG{o}{=}\PYG{n}{mid}\PYG{p}{,}\PYG{n}{l}\PYG{o}{=}\PYG{n}{mid}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{;} \PYG{k}{else} \PYG{n}{r}\PYG{o}{=}\PYG{n}{mid}\PYG{p}{;\PYGZcb{}}
      \PYG{n}{point} \PYG{n}{w1}\PYG{o}{=}\PYG{n}{D}\PYG{p}{[}\PYG{n}{ans}\PYG{p}{];} \PYG{n}{l}\PYG{o}{=}\PYG{n}{where2}\PYG{p}{,}\PYG{n}{r}\PYG{o}{=}\PYG{n}{D}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{ans}\PYG{o}{=}\PYG{n}{D}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{;}
      \PYG{k}{while} \PYG{p}{(}\PYG{n}{l}\PYG{o}{\PYGZlt{}}\PYG{n}{r}\PYG{p}{)\PYGZob{}}\PYG{k+kt}{int} \PYG{n}{mid}\PYG{o}{=}\PYG{n}{l}\PYG{o}{+}\PYG{n}{r}\PYG{o}{\PYGZgt{}\PYGZgt{}}\PYG{l+m+mi}{1}\PYG{p}{;} \PYG{k}{if} \PYG{p}{(}\PYG{n}{clockwise}\PYG{p}{(}\PYG{n}{k}\PYG{p}{,}\PYG{n}{D}\PYG{p}{[}\PYG{n}{mid}\PYG{p}{],}\PYG{n}{D}\PYG{p}{[}\PYG{n}{mid}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{])}\PYG{o}{==\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)} \PYG{n}{l}\PYG{o}{=}\PYG{n}{mid}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{;} \PYG{k}{else} \PYG{n}{ans}\PYG{o}{=}\PYG{n}{mid}\PYG{p}{,}\PYG{n}{r}\PYG{o}{=}\PYG{n}{mid}\PYG{p}{;\PYGZcb{}}
      \PYG{n}{point} \PYG{n}{w2}\PYG{o}{=}\PYG{n}{D}\PYG{p}{[}\PYG{n}{ans}\PYG{p}{];} \PYG{k}{return} \PYG{n+nf}{mp}\PYG{p}{(}\PYG{n}{w1}\PYG{p}{,}\PYG{n}{w2}\PYG{p}{);}
    \PYG{p}{\PYGZcb{}}
  \PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{}}
\PYG{k}{struct} \PYG{n}{P3}\PYG{p}{\PYGZob{}}
  \PYG{n}{db} \PYG{n}{x}\PYG{p}{,}\PYG{n}{y}\PYG{p}{,}\PYG{n}{z}\PYG{p}{;}
  \PYG{n}{P3} \PYG{k}{operator} \PYG{o}{+} \PYG{p}{(}\PYG{n}{P3} \PYG{n}{k1}\PYG{p}{)\PYGZob{}}\PYG{k}{return} \PYG{p}{(}\PYG{n}{P3}\PYG{p}{)\PYGZob{}}\PYG{n}{x}\PYG{o}{+}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,}\PYG{n}{y}\PYG{o}{+}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{y}\PYG{p}{,}\PYG{n}{z}\PYG{o}{+}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{z}\PYG{p}{\PYGZcb{};\PYGZcb{}}
  \PYG{n}{P3} \PYG{k}{operator} \PYG{o}{\PYGZhy{}} \PYG{p}{(}\PYG{n}{P3} \PYG{n}{k1}\PYG{p}{)\PYGZob{}}\PYG{k}{return} \PYG{p}{(}\PYG{n}{P3}\PYG{p}{)\PYGZob{}}\PYG{n}{x}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,}\PYG{n}{y}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{y}\PYG{p}{,}\PYG{n}{z}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{z}\PYG{p}{\PYGZcb{};\PYGZcb{}}
  \PYG{n}{P3} \PYG{k}{operator} \PYG{o}{*} \PYG{p}{(}\PYG{n}{db} \PYG{n}{k1}\PYG{p}{)\PYGZob{}}\PYG{k}{return} \PYG{p}{(}\PYG{n}{P3}\PYG{p}{)\PYGZob{}}\PYG{n}{x}\PYG{o}{*}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{y}\PYG{o}{*}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{z}\PYG{o}{*}\PYG{n}{k1}\PYG{p}{\PYGZcb{};\PYGZcb{}}
  \PYG{n}{P3} \PYG{k}{operator} \PYG{o}{/} \PYG{p}{(}\PYG{n}{db} \PYG{n}{k1}\PYG{p}{)\PYGZob{}}\PYG{k}{return} \PYG{p}{(}\PYG{n}{P3}\PYG{p}{)\PYGZob{}}\PYG{n}{x}\PYG{o}{/}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{y}\PYG{o}{/}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{z}\PYG{o}{/}\PYG{n}{k1}\PYG{p}{\PYGZcb{};\PYGZcb{}}
  \PYG{n}{db} \PYG{n}{abs2}\PYG{p}{()\PYGZob{}}\PYG{k}{return} \PYG{n}{x}\PYG{o}{*}\PYG{n}{x}\PYG{o}{+}\PYG{n}{y}\PYG{o}{*}\PYG{n}{y}\PYG{o}{+}\PYG{n}{z}\PYG{o}{*}\PYG{n}{z}\PYG{p}{;\PYGZcb{}}
  \PYG{n}{db} \PYG{n}{abs}\PYG{p}{()\PYGZob{}}\PYG{k}{return} \PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{x}\PYG{o}{*}\PYG{n}{x}\PYG{o}{+}\PYG{n}{y}\PYG{o}{*}\PYG{n}{y}\PYG{o}{+}\PYG{n}{z}\PYG{o}{*}\PYG{n}{z}\PYG{p}{);\PYGZcb{}}
  \PYG{n}{P3} \PYG{n}{unit}\PYG{p}{()\PYGZob{}}\PYG{k}{return} \PYG{p}{(}\PYG{o}{*}\PYG{k}{this}\PYG{p}{)}\PYG{o}{/}\PYG{n}{abs}\PYG{p}{();\PYGZcb{}}
  \PYG{k+kt}{int} \PYG{k}{operator} \PYG{o}{\PYGZlt{}} \PYG{p}{(}\PYG{k}{const} \PYG{n}{P3} \PYG{n}{k1}\PYG{p}{)} \PYG{k}{const}\PYG{p}{\PYGZob{}}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{cmp}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{)}\PYG{o}{!=}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{return} \PYG{n}{x}\PYG{o}{\PYGZlt{}}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{;}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{cmp}\PYG{p}{(}\PYG{n}{y}\PYG{p}{,}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{y}\PYG{p}{)}\PYG{o}{!=}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{return} \PYG{n}{y}\PYG{o}{\PYGZlt{}}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{y}\PYG{p}{;}
    \PYG{k}{return} \PYG{n+nf}{cmp}\PYG{p}{(}\PYG{n}{z}\PYG{p}{,}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{z}\PYG{p}{)}\PYG{o}{==\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{;}
  \PYG{p}{\PYGZcb{}}
  \PYG{k+kt}{int} \PYG{k}{operator} \PYG{o}{==} \PYG{p}{(}\PYG{k}{const} \PYG{n}{P3} \PYG{n}{k1}\PYG{p}{)\PYGZob{}}
    \PYG{k}{return} \PYG{n}{cmp}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{n}{cmp}\PYG{p}{(}\PYG{n}{y}\PYG{p}{,}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{y}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{n}{cmp}\PYG{p}{(}\PYG{n}{z}\PYG{p}{,}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{z}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{p}{;}
  \PYG{p}{\PYGZcb{}}
  \PYG{k+kt}{void} \PYG{n}{scan}\PYG{p}{()\PYGZob{}}
    \PYG{k+kt}{double} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{,}\PYG{n}{k3}\PYG{p}{;} \PYG{n}{scanf}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}\PYGZpc{}lf\PYGZpc{}lf\PYGZpc{}lf\PYGZdq{}}\PYG{p}{,}\PYG{o}{\PYGZam{}}\PYG{n}{k1}\PYG{p}{,}\PYG{o}{\PYGZam{}}\PYG{n}{k2}\PYG{p}{,}\PYG{o}{\PYGZam{}}\PYG{n}{k3}\PYG{p}{);}
    \PYG{n}{x}\PYG{o}{=}\PYG{n}{k1}\PYG{p}{;} \PYG{n}{y}\PYG{o}{=}\PYG{n}{k2}\PYG{p}{;} \PYG{n}{z}\PYG{o}{=}\PYG{n}{k3}\PYG{p}{;}
  \PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{};}
\PYG{n}{P3} \PYG{n+nf}{cross}\PYG{p}{(}\PYG{n}{P3} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{P3} \PYG{n}{k2}\PYG{p}{)\PYGZob{}}\PYG{k}{return} \PYG{p}{(}\PYG{n}{P3}\PYG{p}{)\PYGZob{}}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{y}\PYG{o}{*}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{z}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{z}\PYG{o}{*}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{y}\PYG{p}{,}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{z}\PYG{o}{*}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{x}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{x}\PYG{o}{*}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{z}\PYG{p}{,}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{x}\PYG{o}{*}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{y}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{y}\PYG{o}{*}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{x}\PYG{p}{\PYGZcb{};\PYGZcb{}}
\PYG{n}{db} \PYG{n+nf}{dot}\PYG{p}{(}\PYG{n}{P3} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{P3} \PYG{n}{k2}\PYG{p}{)\PYGZob{}}\PYG{k}{return} \PYG{n}{k1}\PYG{p}{.}\PYG{n}{x}\PYG{o}{*}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{x}\PYG{o}{+}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{y}\PYG{o}{*}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{y}\PYG{o}{+}\PYG{n}{k1}\PYG{p}{.}\PYG{n}{z}\PYG{o}{*}\PYG{n}{k2}\PYG{p}{.}\PYG{n}{z}\PYG{p}{;\PYGZcb{}}
\PYG{c+c1}{//p=(3,4,5),l=(13,19,21),theta=85 ans=(2.83,4.62,1.77)}
\PYG{n}{P3} \PYG{n+nf}{turn3D}\PYG{p}{(}\PYG{n}{db} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{P3} \PYG{n}{l}\PYG{p}{,}\PYG{n}{P3} \PYG{n}{p}\PYG{p}{)\PYGZob{}}
  \PYG{n}{l}\PYG{o}{=}\PYG{n}{l}\PYG{p}{.}\PYG{n}{unit}\PYG{p}{();} \PYG{n}{P3} \PYG{n}{ans}\PYG{p}{;} \PYG{n}{db} \PYG{n}{c}\PYG{o}{=}\PYG{n}{cos}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{),}\PYG{n}{s}\PYG{o}{=}\PYG{n}{sin}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{);}
  \PYG{n}{ans}\PYG{p}{.}\PYG{n}{x}\PYG{o}{=}\PYG{n}{p}\PYG{p}{.}\PYG{n}{x}\PYG{o}{*}\PYG{p}{(}\PYG{n}{l}\PYG{p}{.}\PYG{n}{x}\PYG{o}{*}\PYG{n}{l}\PYG{p}{.}\PYG{n}{x}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{c}\PYG{p}{)}\PYG{o}{+}\PYG{n}{c}\PYG{p}{)}\PYG{o}{+}\PYG{n}{p}\PYG{p}{.}\PYG{n}{y}\PYG{o}{*}\PYG{p}{(}\PYG{n}{l}\PYG{p}{.}\PYG{n}{x}\PYG{o}{*}\PYG{n}{l}\PYG{p}{.}\PYG{n}{y}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{c}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{n}{l}\PYG{p}{.}\PYG{n}{z}\PYG{o}{*}\PYG{n}{s}\PYG{p}{)}\PYG{o}{+}\PYG{n}{p}\PYG{p}{.}\PYG{n}{z}\PYG{o}{*}\PYG{p}{(}\PYG{n}{l}\PYG{p}{.}\PYG{n}{x}\PYG{o}{*}\PYG{n}{l}\PYG{p}{.}\PYG{n}{z}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{c}\PYG{p}{)}\PYG{o}{+}\PYG{n}{l}\PYG{p}{.}\PYG{n}{y}\PYG{o}{*}\PYG{n}{s}\PYG{p}{);}
  \PYG{n}{ans}\PYG{p}{.}\PYG{n}{y}\PYG{o}{=}\PYG{n}{p}\PYG{p}{.}\PYG{n}{x}\PYG{o}{*}\PYG{p}{(}\PYG{n}{l}\PYG{p}{.}\PYG{n}{x}\PYG{o}{*}\PYG{n}{l}\PYG{p}{.}\PYG{n}{y}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{c}\PYG{p}{)}\PYG{o}{+}\PYG{n}{l}\PYG{p}{.}\PYG{n}{z}\PYG{o}{*}\PYG{n}{s}\PYG{p}{)}\PYG{o}{+}\PYG{n}{p}\PYG{p}{.}\PYG{n}{y}\PYG{o}{*}\PYG{p}{(}\PYG{n}{l}\PYG{p}{.}\PYG{n}{y}\PYG{o}{*}\PYG{n}{l}\PYG{p}{.}\PYG{n}{y}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{c}\PYG{p}{)}\PYG{o}{+}\PYG{n}{c}\PYG{p}{)}\PYG{o}{+}\PYG{n}{p}\PYG{p}{.}\PYG{n}{z}\PYG{o}{*}\PYG{p}{(}\PYG{n}{l}\PYG{p}{.}\PYG{n}{y}\PYG{o}{*}\PYG{n}{l}\PYG{p}{.}\PYG{n}{z}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{c}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{n}{l}\PYG{p}{.}\PYG{n}{x}\PYG{o}{*}\PYG{n}{s}\PYG{p}{);}
  \PYG{n}{ans}\PYG{p}{.}\PYG{n}{z}\PYG{o}{=}\PYG{n}{p}\PYG{p}{.}\PYG{n}{x}\PYG{o}{*}\PYG{p}{(}\PYG{n}{l}\PYG{p}{.}\PYG{n}{x}\PYG{o}{*}\PYG{n}{l}\PYG{p}{.}\PYG{n}{z}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{c}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{n}{l}\PYG{p}{.}\PYG{n}{y}\PYG{o}{*}\PYG{n}{s}\PYG{p}{)}\PYG{o}{+}\PYG{n}{p}\PYG{p}{.}\PYG{n}{y}\PYG{o}{*}\PYG{p}{(}\PYG{n}{l}\PYG{p}{.}\PYG{n}{y}\PYG{o}{*}\PYG{n}{l}\PYG{p}{.}\PYG{n}{z}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{c}\PYG{p}{)}\PYG{o}{+}\PYG{n}{l}\PYG{p}{.}\PYG{n}{x}\PYG{o}{*}\PYG{n}{s}\PYG{p}{)}\PYG{o}{+}\PYG{n}{p}\PYG{p}{.}\PYG{n}{z}\PYG{o}{*}\PYG{p}{(}\PYG{n}{l}\PYG{p}{.}\PYG{n}{x}\PYG{o}{*}\PYG{n}{l}\PYG{p}{.}\PYG{n}{x}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{c}\PYG{p}{)}\PYG{o}{+}\PYG{n}{c}\PYG{p}{);}
  \PYG{k}{return} \PYG{n}{ans}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{k}{typedef} \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{P3}\PYG{o}{\PYGZgt{}} \PYG{n}{VP}\PYG{p}{;}
\PYG{k}{typedef} \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{VP}\PYG{o}{\PYGZgt{}} \PYG{n}{VVP}\PYG{p}{;}
\PYG{n}{db} \PYG{n+nf}{Acos}\PYG{p}{(}\PYG{n}{db} \PYG{n}{x}\PYG{p}{)\PYGZob{}}\PYG{k}{return} \PYG{n}{acos}\PYG{p}{(}\PYG{n}{max}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{p}{(}\PYG{n}{db}\PYG{p}{)}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{min}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,(}\PYG{n}{db}\PYG{p}{)}\PYG{l+m+mi}{1}\PYG{p}{)));\PYGZcb{}}
\PYG{c+c1}{// 球面距离 , 圆心原点 , 半径 1}
\PYG{n}{db} \PYG{n+nf}{Odist}\PYG{p}{(}\PYG{n}{P3} \PYG{n}{a}\PYG{p}{,}\PYG{n}{P3} \PYG{n}{b}\PYG{p}{)\PYGZob{}}\PYG{n}{db} \PYG{n}{r}\PYG{o}{=}\PYG{n}{Acos}\PYG{p}{(}\PYG{n}{dot}\PYG{p}{(}\PYG{n}{a}\PYG{p}{,}\PYG{n}{b}\PYG{p}{));} \PYG{k}{return} \PYG{n}{r}\PYG{p}{;\PYGZcb{}}
\PYG{n}{db} \PYG{n}{r}\PYG{p}{;} \PYG{n}{P3} \PYG{n}{rnd}\PYG{p}{;}
\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{db}\PYG{o}{\PYGZgt{}} \PYG{n}{solve}\PYG{p}{(}\PYG{n}{db} \PYG{n}{a}\PYG{p}{,}\PYG{n}{db} \PYG{n}{b}\PYG{p}{,}\PYG{n}{db} \PYG{n}{c}\PYG{p}{)\PYGZob{}}
  \PYG{n}{db} \PYG{n}{r}\PYG{o}{=}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{a}\PYG{o}{*}\PYG{n}{a}\PYG{o}{+}\PYG{n}{b}\PYG{o}{*}\PYG{n}{b}\PYG{p}{),}\PYG{n}{th}\PYG{o}{=}\PYG{n}{atan2}\PYG{p}{(}\PYG{n}{b}\PYG{p}{,}\PYG{n}{a}\PYG{p}{);}
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{cmp}\PYG{p}{(}\PYG{n}{c}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{n}{r}\PYG{p}{)}\PYG{o}{==\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)} \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{l+m+mi}{0}\PYG{p}{\PYGZcb{};}
  \PYG{k}{else} \PYG{n+nf}{if} \PYG{p}{(}\PYG{n}{cmp}\PYG{p}{(}\PYG{n}{r}\PYG{p}{,}\PYG{n}{c}\PYG{p}{)}\PYG{o}{\PYGZlt{}=}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{l+m+mi}{1}\PYG{p}{\PYGZcb{};}
  \PYG{k}{else} \PYG{p}{\PYGZob{}}
    \PYG{n}{db} \PYG{n}{tr}\PYG{o}{=}\PYG{n}{pi}\PYG{o}{\PYGZhy{}}\PYG{n}{Acos}\PYG{p}{(}\PYG{n}{c}\PYG{o}{/}\PYG{n}{r}\PYG{p}{);} \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{n}{th}\PYG{o}{+}\PYG{n}{pi}\PYG{o}{\PYGZhy{}}\PYG{n}{tr}\PYG{p}{,}\PYG{n}{th}\PYG{o}{+}\PYG{n}{pi}\PYG{o}{+}\PYG{n}{tr}\PYG{p}{\PYGZcb{};}
  \PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{}}
\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{db}\PYG{o}{\PYGZgt{}} \PYG{n}{jiao}\PYG{p}{(}\PYG{n}{P3} \PYG{n}{a}\PYG{p}{,}\PYG{n}{P3} \PYG{n}{b}\PYG{p}{)\PYGZob{}}
  \PYG{c+c1}{// dot(rd+x*cos(t)+y*sin(t),b) \PYGZgt{}= cos(r)}
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{cmp}\PYG{p}{(}\PYG{n}{Odist}\PYG{p}{(}\PYG{n}{a}\PYG{p}{,}\PYG{n}{b}\PYG{p}{),}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{r}\PYG{p}{)}\PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{l+m+mi}{0}\PYG{p}{\PYGZcb{};}
  \PYG{n}{P3} \PYG{n}{rd}\PYG{o}{=}\PYG{n}{a}\PYG{o}{*}\PYG{n}{cos}\PYG{p}{(}\PYG{n}{r}\PYG{p}{),}\PYG{n}{z}\PYG{o}{=}\PYG{n}{a}\PYG{p}{.}\PYG{n}{unit}\PYG{p}{(),}\PYG{n}{y}\PYG{o}{=}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{z}\PYG{p}{,}\PYG{n}{rnd}\PYG{p}{).}\PYG{n}{unit}\PYG{p}{(),}\PYG{n}{x}\PYG{o}{=}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{y}\PYG{p}{,}\PYG{n}{z}\PYG{p}{).}\PYG{n}{unit}\PYG{p}{();}
  \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{db}\PYG{o}{\PYGZgt{}} \PYG{n}{ret} \PYG{o}{=} \PYG{n}{solve}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{p}{(}\PYG{n}{dot}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,}\PYG{n}{b}\PYG{p}{)}\PYG{o}{*}\PYG{n}{sin}\PYG{p}{(}\PYG{n}{r}\PYG{p}{)),}\PYG{o}{\PYGZhy{}}\PYG{p}{(}\PYG{n}{dot}\PYG{p}{(}\PYG{n}{y}\PYG{p}{,}\PYG{n}{b}\PYG{p}{)}\PYG{o}{*}\PYG{n}{sin}\PYG{p}{(}\PYG{n}{r}\PYG{p}{)),}\PYG{o}{\PYGZhy{}}\PYG{p}{(}\PYG{n}{cos}\PYG{p}{(}\PYG{n}{r}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{n}{dot}\PYG{p}{(}\PYG{n}{rd}\PYG{p}{,}\PYG{n}{b}\PYG{p}{)));} 
  \PYG{k}{return} \PYG{n}{ret}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{n}{db} \PYG{n}{norm}\PYG{p}{(}\PYG{n}{db} \PYG{n}{x}\PYG{p}{,}\PYG{n}{db} \PYG{n}{l}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{db} \PYG{n}{r}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{pi}\PYG{p}{)\PYGZob{}} \PYG{c+c1}{// change x into [l,r)}
  \PYG{k}{while} \PYG{p}{(}\PYG{n}{cmp}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,}\PYG{n}{l}\PYG{p}{)}\PYG{o}{==\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)} \PYG{n}{x}\PYG{o}{+=}\PYG{p}{(}\PYG{n}{r}\PYG{o}{\PYGZhy{}}\PYG{n}{l}\PYG{p}{);} \PYG{k}{while} \PYG{p}{(}\PYG{n}{cmp}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,}\PYG{n}{r}\PYG{p}{)}\PYG{o}{\PYGZgt{}=}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{n}{x}\PYG{o}{\PYGZhy{}=}\PYG{p}{(}\PYG{n}{r}\PYG{o}{\PYGZhy{}}\PYG{n}{l}\PYG{p}{);}
  \PYG{k}{return} \PYG{n}{x}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{n}{db} \PYG{n}{disLP}\PYG{p}{(}\PYG{n}{P3} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{P3} \PYG{n}{k2}\PYG{p}{,}\PYG{n}{P3} \PYG{n}{q}\PYG{p}{)\PYGZob{}}
  \PYG{k}{return} \PYG{p}{(}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{k2}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{q}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{)).}\PYG{n}{abs}\PYG{p}{()}\PYG{o}{/}\PYG{p}{(}\PYG{n}{k2}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{).}\PYG{n}{abs}\PYG{p}{();}
\PYG{p}{\PYGZcb{}}
\PYG{n}{db} \PYG{n}{disLL}\PYG{p}{(}\PYG{n}{P3} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{P3} \PYG{n}{k2}\PYG{p}{,}\PYG{n}{P3} \PYG{n}{k3}\PYG{p}{,}\PYG{n}{P3} \PYG{n}{k4}\PYG{p}{)\PYGZob{}}
  \PYG{n}{P3} \PYG{n}{dir}\PYG{o}{=}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{k2}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k4}\PYG{o}{\PYGZhy{}}\PYG{n}{k3}\PYG{p}{);} \PYG{k}{if} \PYG{p}{(}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{dir}\PYG{p}{.}\PYG{n}{abs}\PYG{p}{())}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{return} \PYG{n}{disLP}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k2}\PYG{p}{,}\PYG{n}{k3}\PYG{p}{);}
  \PYG{k}{return} \PYG{n+nf}{fabs}\PYG{p}{(}\PYG{n}{dot}\PYG{p}{(}\PYG{n}{dir}\PYG{p}{.}\PYG{n}{unit}\PYG{p}{(),}\PYG{n}{k1}\PYG{o}{\PYGZhy{}}\PYG{n}{k2}\PYG{p}{));}
\PYG{p}{\PYGZcb{}}
\PYG{n}{VP} \PYG{n}{getFL}\PYG{p}{(}\PYG{n}{P3} \PYG{n}{p}\PYG{p}{,}\PYG{n}{P3} \PYG{n}{dir}\PYG{p}{,}\PYG{n}{P3} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{P3} \PYG{n}{k2}\PYG{p}{)\PYGZob{}}
  \PYG{n}{db} \PYG{n}{a}\PYG{o}{=}\PYG{n}{dot}\PYG{p}{(}\PYG{n}{k2}\PYG{o}{\PYGZhy{}}\PYG{n}{p}\PYG{p}{,}\PYG{n}{dir}\PYG{p}{),}\PYG{n}{b}\PYG{o}{=}\PYG{n}{dot}\PYG{p}{(}\PYG{n}{k1}\PYG{o}{\PYGZhy{}}\PYG{n}{p}\PYG{p}{,}\PYG{n}{dir}\PYG{p}{),}\PYG{n}{d}\PYG{o}{=}\PYG{n}{a}\PYG{o}{\PYGZhy{}}\PYG{n}{b}\PYG{p}{;}
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{fabs}\PYG{p}{(}\PYG{n}{d}\PYG{p}{))}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{return} \PYG{p}{\PYGZob{}\PYGZcb{};}
  \PYG{k}{return} \PYG{p}{\PYGZob{}(}\PYG{n}{k1}\PYG{o}{*}\PYG{n}{a}\PYG{o}{\PYGZhy{}}\PYG{n}{k2}\PYG{o}{*}\PYG{n}{b}\PYG{p}{)}\PYG{o}{/}\PYG{n}{d}\PYG{p}{\PYGZcb{};}
\PYG{p}{\PYGZcb{}}
\PYG{n}{VP} \PYG{n}{getFF}\PYG{p}{(}\PYG{n}{P3} \PYG{n}{p1}\PYG{p}{,}\PYG{n}{P3} \PYG{n}{dir1}\PYG{p}{,}\PYG{n}{P3} \PYG{n}{p2}\PYG{p}{,}\PYG{n}{P3} \PYG{n}{dir2}\PYG{p}{)\PYGZob{}}\PYG{c+c1}{// 返回一条线}
  \PYG{n}{P3} \PYG{n}{e}\PYG{o}{=}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{dir1}\PYG{p}{,}\PYG{n}{dir2}\PYG{p}{),}\PYG{n}{v}\PYG{o}{=}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{dir1}\PYG{p}{,}\PYG{n}{e}\PYG{p}{);}
  \PYG{n}{db} \PYG{n}{d}\PYG{o}{=}\PYG{n}{dot}\PYG{p}{(}\PYG{n}{dir2}\PYG{p}{,}\PYG{n}{v}\PYG{p}{);} \PYG{k}{if} \PYG{p}{(}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{abs}\PYG{p}{(}\PYG{n}{d}\PYG{p}{))}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{return} \PYG{p}{\PYGZob{}\PYGZcb{};}
  \PYG{n}{P3} \PYG{n}{q}\PYG{o}{=}\PYG{n}{p1}\PYG{o}{+}\PYG{n}{v}\PYG{o}{*}\PYG{n}{dot}\PYG{p}{(}\PYG{n}{dir2}\PYG{p}{,}\PYG{n}{p2}\PYG{o}{\PYGZhy{}}\PYG{n}{p1}\PYG{p}{)}\PYG{o}{/}\PYG{n}{d}\PYG{p}{;} \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{n}{q}\PYG{p}{,}\PYG{n}{q}\PYG{o}{+}\PYG{n}{e}\PYG{p}{\PYGZcb{};}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{// 3D Covex Hull Template}
\PYG{n}{db} \PYG{n}{getV}\PYG{p}{(}\PYG{n}{P3} \PYG{n}{k1}\PYG{p}{,}\PYG{n}{P3} \PYG{n}{k2}\PYG{p}{,}\PYG{n}{P3} \PYG{n}{k3}\PYG{p}{,}\PYG{n}{P3} \PYG{n}{k4}\PYG{p}{)\PYGZob{}} \PYG{c+c1}{// get the Volume}
  \PYG{k}{return} \PYG{n}{dot}\PYG{p}{(}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{k2}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{,}\PYG{n}{k3}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{),}\PYG{n}{k4}\PYG{o}{\PYGZhy{}}\PYG{n}{k1}\PYG{p}{);}
\PYG{p}{\PYGZcb{}}
\PYG{n}{db} \PYG{n}{rand\PYGZus{}db}\PYG{p}{()\PYGZob{}}\PYG{k}{return} \PYG{l+m+mf}{1.0}\PYG{o}{*}\PYG{n}{rand}\PYG{p}{()}\PYG{o}{/}\PYG{n}{RAND\PYGZus{}MAX}\PYG{p}{;\PYGZcb{}}
\PYG{n}{VP} \PYG{n}{convexHull2D}\PYG{p}{(}\PYG{n}{VP} \PYG{n}{A}\PYG{p}{,}\PYG{n}{P3} \PYG{n}{dir}\PYG{p}{)\PYGZob{}}
  \PYG{n}{P3} \PYG{n}{x}\PYG{o}{=}\PYG{p}{\PYGZob{}(}\PYG{n}{db}\PYG{p}{)}\PYG{n}{rand}\PYG{p}{(),(}\PYG{n}{db}\PYG{p}{)}\PYG{n}{rand}\PYG{p}{(),(}\PYG{n}{db}\PYG{p}{)}\PYG{n}{rand}\PYG{p}{()\PYGZcb{};} \PYG{n}{x}\PYG{o}{=}\PYG{n}{x}\PYG{p}{.}\PYG{n}{unit}\PYG{p}{();}
  \PYG{n}{x}\PYG{o}{=}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,}\PYG{n}{dir}\PYG{p}{).}\PYG{n}{unit}\PYG{p}{();} \PYG{n}{P3} \PYG{n}{y}\PYG{o}{=}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,}\PYG{n}{dir}\PYG{p}{).}\PYG{n}{unit}\PYG{p}{();}
  \PYG{n}{P3} \PYG{n}{vec}\PYG{o}{=}\PYG{n}{dir}\PYG{p}{.}\PYG{n}{unit}\PYG{p}{()}\PYG{o}{*}\PYG{n}{dot}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{],}\PYG{n}{dir}\PYG{p}{);}
  \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{point}\PYG{o}{\PYGZgt{}}\PYG{n}{B}\PYG{p}{;}
  \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}}\PYG{n}{A}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)} \PYG{n}{B}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{((}\PYG{n}{point}\PYG{p}{)\PYGZob{}}\PYG{n}{dot}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],}\PYG{n}{x}\PYG{p}{),}\PYG{n}{dot}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],}\PYG{n}{y}\PYG{p}{)\PYGZcb{});}
  \PYG{n}{B}\PYG{o}{=}\PYG{n}{ConvexHull}\PYG{p}{(}\PYG{n}{B}\PYG{p}{);} \PYG{n}{A}\PYG{p}{.}\PYG{n}{clear}\PYG{p}{();}
  \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}}\PYG{n}{B}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)} \PYG{n}{A}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{x}\PYG{o}{*}\PYG{n}{B}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{x}\PYG{o}{+}\PYG{n}{y}\PYG{o}{*}\PYG{n}{B}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{y}\PYG{o}{+}\PYG{n}{vec}\PYG{p}{);}
  \PYG{k}{return} \PYG{n}{A}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{k}{namespace} \PYG{n}{CH3}\PYG{p}{\PYGZob{}}
  \PYG{n}{VVP} \PYG{n}{ret}\PYG{p}{;} \PYG{n}{set}\PYG{o}{\PYGZlt{}}\PYG{n}{pair}\PYG{o}{\PYGZlt{}}\PYG{k+kt}{int}\PYG{p}{,}\PYG{k+kt}{int}\PYG{o}{\PYGZgt{}} \PYG{o}{\PYGZgt{}}\PYG{n}{e}\PYG{p}{;}
  \PYG{k+kt}{int} \PYG{n}{n}\PYG{p}{;} \PYG{n}{VP} \PYG{n}{p}\PYG{p}{,}\PYG{n}{q}\PYG{p}{;}
  \PYG{k+kt}{void} \PYG{n+nf}{wrap}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{a}\PYG{p}{,}\PYG{k+kt}{int} \PYG{n}{b}\PYG{p}{)\PYGZob{}}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{e}\PYG{p}{.}\PYG{n}{find}\PYG{p}{(\PYGZob{}}\PYG{n}{a}\PYG{p}{,}\PYG{n}{b}\PYG{p}{\PYGZcb{})}\PYG{o}{==}\PYG{n}{e}\PYG{p}{.}\PYG{n}{end}\PYG{p}{())\PYGZob{}}
      \PYG{k+kt}{int} \PYG{n}{c}\PYG{o}{=\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{;}
      \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}}\PYG{n}{n}\PYG{p}{;}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)} \PYG{k}{if} \PYG{p}{(}\PYG{n}{i}\PYG{o}{!=}\PYG{n}{a}\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{n}{i}\PYG{o}{!=}\PYG{n}{b}\PYG{p}{)\PYGZob{}}
        \PYG{k}{if} \PYG{p}{(}\PYG{n}{c}\PYG{o}{==\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{o}{||}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{getV}\PYG{p}{(}\PYG{n}{q}\PYG{p}{[}\PYG{n}{c}\PYG{p}{],}\PYG{n}{q}\PYG{p}{[}\PYG{n}{a}\PYG{p}{],}\PYG{n}{q}\PYG{p}{[}\PYG{n}{b}\PYG{p}{],}\PYG{n}{q}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]))}\PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{n}{c}\PYG{o}{=}\PYG{n}{i}\PYG{p}{;}
      \PYG{p}{\PYGZcb{}}
      \PYG{k}{if} \PYG{p}{(}\PYG{n}{c}\PYG{o}{!=\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)\PYGZob{}}
        \PYG{n}{ret}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(\PYGZob{}}\PYG{n}{p}\PYG{p}{[}\PYG{n}{a}\PYG{p}{],}\PYG{n}{p}\PYG{p}{[}\PYG{n}{b}\PYG{p}{],}\PYG{n}{p}\PYG{p}{[}\PYG{n}{c}\PYG{p}{]\PYGZcb{});}
        \PYG{n}{e}\PYG{p}{.}\PYG{n}{insert}\PYG{p}{(\PYGZob{}}\PYG{n}{a}\PYG{p}{,}\PYG{n}{b}\PYG{p}{\PYGZcb{});} \PYG{n}{e}\PYG{p}{.}\PYG{n}{insert}\PYG{p}{(\PYGZob{}}\PYG{n}{b}\PYG{p}{,}\PYG{n}{c}\PYG{p}{\PYGZcb{});} \PYG{n}{e}\PYG{p}{.}\PYG{n}{insert}\PYG{p}{(\PYGZob{}}\PYG{n}{c}\PYG{p}{,}\PYG{n}{a}\PYG{p}{\PYGZcb{});}
        \PYG{n}{wrap}\PYG{p}{(}\PYG{n}{c}\PYG{p}{,}\PYG{n}{b}\PYG{p}{);} \PYG{n}{wrap}\PYG{p}{(}\PYG{n}{a}\PYG{p}{,}\PYG{n}{c}\PYG{p}{);}
      \PYG{p}{\PYGZcb{}}
    \PYG{p}{\PYGZcb{}}
  \PYG{p}{\PYGZcb{}}
  \PYG{n}{VVP} \PYG{n+nf}{ConvexHull3D}\PYG{p}{(}\PYG{n}{VP} \PYG{n}{\PYGZus{}p}\PYG{p}{)\PYGZob{}}
    \PYG{n}{p}\PYG{o}{=}\PYG{n}{q}\PYG{o}{=}\PYG{n}{\PYGZus{}p}\PYG{p}{;} \PYG{n}{n}\PYG{o}{=}\PYG{n}{p}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}
    \PYG{n}{ret}\PYG{p}{.}\PYG{n}{clear}\PYG{p}{();} \PYG{n}{e}\PYG{p}{.}\PYG{n}{clear}\PYG{p}{();}
    \PYG{k}{for} \PYG{p}{(}\PYG{k}{auto} \PYG{o}{\PYGZam{}}\PYG{n+nl}{i}\PYG{p}{:}\PYG{n}{q}\PYG{p}{)} \PYG{n}{i}\PYG{o}{=}\PYG{n}{i}\PYG{o}{+}\PYG{p}{(}\PYG{n}{P3}\PYG{p}{)\PYGZob{}}\PYG{n}{rand\PYGZus{}db}\PYG{p}{()}\PYG{o}{*}\PYG{l+m+mf}{1e\PYGZhy{}4}\PYG{p}{,}\PYG{n}{rand\PYGZus{}db}\PYG{p}{()}\PYG{o}{*}\PYG{l+m+mf}{1e\PYGZhy{}4}\PYG{p}{,}\PYG{n}{rand\PYGZus{}db}\PYG{p}{()}\PYG{o}{*}\PYG{l+m+mf}{1e\PYGZhy{}4}\PYG{p}{\PYGZcb{};}
    \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}}\PYG{n}{n}\PYG{p}{;}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)} \PYG{k}{if} \PYG{p}{(}\PYG{n}{q}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{x}\PYG{o}{\PYGZlt{}}\PYG{n}{q}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{].}\PYG{n}{x}\PYG{p}{)} \PYG{n}{swap}\PYG{p}{(}\PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{],}\PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]),}\PYG{n}{swap}\PYG{p}{(}\PYG{n}{q}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{],}\PYG{n}{q}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]);}
    \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}}\PYG{n}{n}\PYG{p}{;}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)} \PYG{k}{if} \PYG{p}{((}\PYG{n}{q}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{x}\PYG{o}{\PYGZhy{}}\PYG{n}{q}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{].}\PYG{n}{x}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n}{q}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{].}\PYG{n}{y}\PYG{o}{\PYGZhy{}}\PYG{n}{q}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{].}\PYG{n}{y}\PYG{p}{)}\PYG{o}{\PYGZgt{}}\PYG{p}{(}\PYG{n}{q}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{y}\PYG{o}{\PYGZhy{}}\PYG{n}{q}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{].}\PYG{n}{y}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n}{q}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{].}\PYG{n}{x}\PYG{o}{\PYGZhy{}}\PYG{n}{q}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{].}\PYG{n}{x}\PYG{p}{))} \PYG{n}{swap}\PYG{p}{(}\PYG{n}{q}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{],}\PYG{n}{q}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]),}\PYG{n}{swap}\PYG{p}{(}\PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{],}\PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]);}
    \PYG{n}{wrap}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{);}
    \PYG{k}{return} \PYG{n}{ret}\PYG{p}{;}
  \PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{}}
\PYG{n}{VVP} \PYG{n}{reduceCH}\PYG{p}{(}\PYG{n}{VVP} \PYG{n}{A}\PYG{p}{)\PYGZob{}}
  \PYG{n}{VVP} \PYG{n}{ret}\PYG{p}{;} \PYG{n}{map}\PYG{o}{\PYGZlt{}}\PYG{n}{P3}\PYG{p}{,}\PYG{n}{VP}\PYG{o}{\PYGZgt{}} \PYG{n}{M}\PYG{p}{;}
  \PYG{k}{for} \PYG{p}{(}\PYG{n}{VP} \PYG{n+nl}{nowF}\PYG{p}{:}\PYG{n}{A}\PYG{p}{)\PYGZob{}}
    \PYG{n}{P3} \PYG{n}{dir}\PYG{o}{=}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{nowF}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{nowF}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{],}\PYG{n}{nowF}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{nowF}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]).}\PYG{n}{unit}\PYG{p}{();}
    \PYG{k}{for} \PYG{p}{(}\PYG{n}{P3} \PYG{n+nl}{k1}\PYG{p}{:}\PYG{n}{nowF}\PYG{p}{)} \PYG{n}{M}\PYG{p}{[}\PYG{n}{dir}\PYG{p}{].}\PYG{n}{pb}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{);}
  \PYG{p}{\PYGZcb{}}
  \PYG{k}{for} \PYG{p}{(}\PYG{n}{pair}\PYG{o}{\PYGZlt{}}\PYG{n}{P3}\PYG{p}{,}\PYG{n}{VP}\PYG{o}{\PYGZgt{}} \PYG{n+nl}{nowF}\PYG{p}{:}\PYG{n}{M}\PYG{p}{)} \PYG{n}{ret}\PYG{p}{.}\PYG{n}{pb}\PYG{p}{(}\PYG{n}{convexHull2D}\PYG{p}{(}\PYG{n}{nowF}\PYG{p}{.}\PYG{n}{se}\PYG{p}{,}\PYG{n}{nowF}\PYG{p}{.}\PYG{n}{fi}\PYG{p}{));}
  \PYG{k}{return} \PYG{n}{ret}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{//  把一个面变成 ( 点 , 法向量 ) 的形式}
\PYG{n}{pair}\PYG{o}{\PYGZlt{}}\PYG{n}{P3}\PYG{p}{,}\PYG{n}{P3}\PYG{o}{\PYGZgt{}} \PYG{n}{getF}\PYG{p}{(}\PYG{n}{VP} \PYG{n}{F}\PYG{p}{)\PYGZob{}}
  \PYG{k}{return} \PYG{n}{mp}\PYG{p}{(}\PYG{n}{F}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{],}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{F}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{F}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{],}\PYG{n}{F}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{F}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]).}\PYG{n}{unit}\PYG{p}{());}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{// 3D Cut 保留 dot(dir,x\PYGZhy{}p)\PYGZgt{}=0 的部分}
\PYG{n}{VVP} \PYG{n}{ConvexCut3D}\PYG{p}{(}\PYG{n}{VVP} \PYG{n}{A}\PYG{p}{,}\PYG{n}{P3} \PYG{n}{p}\PYG{p}{,}\PYG{n}{P3} \PYG{n}{dir}\PYG{p}{)\PYGZob{}}
  \PYG{n}{VVP} \PYG{n}{ret}\PYG{p}{;} \PYG{n}{VP} \PYG{n}{sec}\PYG{p}{;}
  \PYG{k}{for} \PYG{p}{(}\PYG{n}{VP} \PYG{n+nl}{nowF}\PYG{p}{:} \PYG{n}{A}\PYG{p}{)\PYGZob{}}
    \PYG{k+kt}{int} \PYG{n}{n}\PYG{o}{=}\PYG{n}{nowF}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();} \PYG{n}{VP} \PYG{n}{ans}\PYG{p}{;} \PYG{k+kt}{int} \PYG{n}{dif}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}
    \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}}\PYG{n}{n}\PYG{p}{;}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)\PYGZob{}}
      \PYG{k+kt}{int} \PYG{n}{d1}\PYG{o}{=}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{dot}\PYG{p}{(}\PYG{n}{dir}\PYG{p}{,}\PYG{n}{nowF}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{p}\PYG{p}{));}
      \PYG{k+kt}{int} \PYG{n}{d2}\PYG{o}{=}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{dot}\PYG{p}{(}\PYG{n}{dir}\PYG{p}{,}\PYG{n}{nowF}\PYG{p}{[(}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{n}{n}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{p}\PYG{p}{));}
      \PYG{k}{if} \PYG{p}{(}\PYG{n}{d1}\PYG{o}{\PYGZgt{}=}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{n}{ans}\PYG{p}{.}\PYG{n}{pb}\PYG{p}{(}\PYG{n}{nowF}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]);}
      \PYG{k}{if} \PYG{p}{(}\PYG{n}{d1}\PYG{o}{*}\PYG{n}{d2}\PYG{o}{\PYGZlt{}}\PYG{l+m+mi}{0}\PYG{p}{)\PYGZob{}}
        \PYG{n}{P3} \PYG{n}{q}\PYG{o}{=}\PYG{n}{getFL}\PYG{p}{(}\PYG{n}{p}\PYG{p}{,}\PYG{n}{dir}\PYG{p}{,}\PYG{n}{nowF}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],}\PYG{n}{nowF}\PYG{p}{[(}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{n}{n}\PYG{p}{])[}\PYG{l+m+mi}{0}\PYG{p}{];}
        \PYG{n}{ans}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{q}\PYG{p}{);} \PYG{n}{sec}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{q}\PYG{p}{);}
      \PYG{p}{\PYGZcb{}}
      \PYG{k}{if} \PYG{p}{(}\PYG{n}{d1}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{n}{sec}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{nowF}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]);} \PYG{k}{else} \PYG{n}{dif}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{;}
      \PYG{n}{dif}\PYG{o}{|=}\PYG{p}{(}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{dot}\PYG{p}{(}\PYG{n}{dir}\PYG{p}{,}\PYG{n}{cross}\PYG{p}{(}\PYG{n}{nowF}\PYG{p}{[(}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{n}{n}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{nowF}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],}\PYG{n}{nowF}\PYG{p}{[(}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{n}{n}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{nowF}\PYG{p}{[}\PYG{n}{i}\PYG{p}{])))}\PYG{o}{==\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{);}
    \PYG{p}{\PYGZcb{}}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{ans}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{0}\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{n}{dif}\PYG{p}{)} \PYG{n}{ret}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{ans}\PYG{p}{);}
  \PYG{p}{\PYGZcb{}}
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{sec}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{n}{ret}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{convexHull2D}\PYG{p}{(}\PYG{n}{sec}\PYG{p}{,}\PYG{n}{dir}\PYG{p}{));}
  \PYG{k}{return} \PYG{n}{ret}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{n}{db} \PYG{n}{vol}\PYG{p}{(}\PYG{n}{VVP} \PYG{n}{A}\PYG{p}{)\PYGZob{}}
  \PYG{k}{if} \PYG{p}{(}\PYG{n}{A}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()}\PYG{o}{==}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{return} \PYG{l+m+mi}{0}\PYG{p}{;} \PYG{n}{P3} \PYG{n}{p}\PYG{o}{=}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{][}\PYG{l+m+mi}{0}\PYG{p}{];} \PYG{n}{db} \PYG{n}{ans}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}
  \PYG{k}{for} \PYG{p}{(}\PYG{n}{VP} \PYG{n+nl}{nowF}\PYG{p}{:}\PYG{n}{A}\PYG{p}{)}
    \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}}\PYG{n}{nowF}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)}
      \PYG{n}{ans}\PYG{o}{+=}\PYG{n}{abs}\PYG{p}{(}\PYG{n}{getV}\PYG{p}{(}\PYG{n}{p}\PYG{p}{,}\PYG{n}{nowF}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{],}\PYG{n}{nowF}\PYG{p}{[}\PYG{n}{i}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{],}\PYG{n}{nowF}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]));}
  \PYG{k}{return} \PYG{n}{ans}\PYG{o}{/}\PYG{l+m+mi}{6}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{n}{VVP} \PYG{n}{init}\PYG{p}{(}\PYG{n}{db} \PYG{n}{INF}\PYG{p}{)} \PYG{p}{\PYGZob{}}
  \PYG{n}{VVP} \PYG{n}{pss}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{n}{VP}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{));}
  \PYG{n}{pss}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{][}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pss}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{][}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pss}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{][}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{o}{\PYGZhy{}}\PYG{n}{INF}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{n}{INF}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{n}{INF}\PYG{p}{\PYGZcb{};}
  \PYG{n}{pss}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{][}\PYG{l+m+mi}{3}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pss}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{][}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pss}\PYG{p}{[}\PYG{l+m+mi}{5}\PYG{p}{][}\PYG{l+m+mi}{2}\PYG{p}{]} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{o}{\PYGZhy{}}\PYG{n}{INF}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{n}{INF}\PYG{p}{,} \PYG{n}{INF}\PYG{p}{\PYGZcb{};}
  \PYG{n}{pss}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{][}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pss}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{][}\PYG{l+m+mi}{3}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pss}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{][}\PYG{l+m+mi}{2}\PYG{p}{]} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{o}{\PYGZhy{}}\PYG{n}{INF}\PYG{p}{,} \PYG{n}{INF}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{n}{INF}\PYG{p}{\PYGZcb{};}
  \PYG{n}{pss}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{][}\PYG{l+m+mi}{2}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pss}\PYG{p}{[}\PYG{l+m+mi}{5}\PYG{p}{][}\PYG{l+m+mi}{3}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pss}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{][}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{o}{\PYGZhy{}}\PYG{n}{INF}\PYG{p}{,} \PYG{n}{INF}\PYG{p}{,} \PYG{n}{INF}\PYG{p}{\PYGZcb{};}
  \PYG{n}{pss}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{][}\PYG{l+m+mi}{3}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pss}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{][}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pss}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{][}\PYG{l+m+mi}{2}\PYG{p}{]} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{n}{INF}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{n}{INF}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{n}{INF}\PYG{p}{\PYGZcb{};}
  \PYG{n}{pss}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{][}\PYG{l+m+mi}{2}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pss}\PYG{p}{[}\PYG{l+m+mi}{5}\PYG{p}{][}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pss}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{][}\PYG{l+m+mi}{3}\PYG{p}{]} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{n}{INF}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{n}{INF}\PYG{p}{,} \PYG{n}{INF}\PYG{p}{\PYGZcb{};}
  \PYG{n}{pss}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{][}\PYG{l+m+mi}{2}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pss}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{][}\PYG{l+m+mi}{3}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pss}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{][}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{n}{INF}\PYG{p}{,} \PYG{n}{INF}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{n}{INF}\PYG{p}{\PYGZcb{};}
  \PYG{n}{pss}\PYG{p}{[}\PYG{l+m+mi}{5}\PYG{p}{][}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pss}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{][}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pss}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{][}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{n}{INF}\PYG{p}{,} \PYG{n}{INF}\PYG{p}{,} \PYG{n}{INF}\PYG{p}{\PYGZcb{};}
  \PYG{k}{return} \PYG{n}{pss}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\end{Verbatim}
